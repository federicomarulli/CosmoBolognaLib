<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CosmoBolognaLib: cbl::modelling::Modelling Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CosmoBolognaLib
   </div>
   <div id="projectbrief">Free Software C++/Python libraries for cosmological calculations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('de/ddc/classcbl_1_1modelling_1_1Modelling.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../d3/dd6/classcbl_1_1modelling_1_1Modelling-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">cbl::modelling::Modelling Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The class <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html" title="The class Modelling.">Modelling</a>.  
 <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="../../d5/d4c/Modelling_8h_source.html">Headers/Modelling.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for cbl::modelling::Modelling:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/de5/classcbl_1_1modelling_1_1Modelling__inherit__graph.png" border="0" usemap="#cbl_1_1modelling_1_1Modelling_inherit__map" alt="Inheritance graph"/></div>
<map name="cbl_1_1modelling_1_1Modelling_inherit__map" id="cbl_1_1modelling_1_1Modelling_inherit__map">
<area shape="rect" title="The class Modelling." alt="" coords="5,281,192,307"/>
<area shape="rect" href="../../d4/d74/classcbl_1_1modelling_1_1cosmo_1_1Modelling__Cosmology.html" title="The class Modelling_Cosmology." alt="" coords="274,168,449,209"/>
<area shape="rect" href="../../d0/d02/classcbl_1_1modelling_1_1numbercounts_1_1Modelling__NumberCounts.html" title="The class Modelling_NumberCounts." alt="" coords="254,233,469,275"/>
<area shape="rect" href="../../d3/d4f/classcbl_1_1modelling_1_1threept_1_1Modelling__ThreePointCorrelation.html" title="The class Modelling_ThreePointCorrelation." alt="" coords="240,305,483,347"/>
<area shape="rect" href="../../d0/d7c/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation.html" title="The class Modelling_TwoPointCorrelation." alt="" coords="246,505,477,547"/>
<area shape="rect" href="../../d3/df9/classcbl_1_1modelling_1_1numbercounts_1_1Modelling__NumberCounts1D.html" title="The class Modelling_NumberCounts1D." alt="" coords="547,116,763,157"/>
<area shape="rect" href="../../d7/d90/classcbl_1_1modelling_1_1numbercounts_1_1Modelling__NumberCounts2D.html" title="The class Modelling_NumberCounts2D." alt="" coords="547,228,763,269"/>
<area shape="rect" href="../../de/d0a/classcbl_1_1modelling_1_1numbercounts_1_1Modelling__NumberCounts1D__Mass.html" title="The class Modelling_NumberCounts1D_Mass." alt="" coords="828,5,1085,47"/>
<area shape="rect" href="../../d1/dcb/classcbl_1_1modelling_1_1numbercounts_1_1Modelling__NumberCounts1D__Redshift.html" title="The class Modelling_NumberCounts1D_Redshift." alt="" coords="849,71,1065,127"/>
<area shape="rect" href="../../d8/d4b/classcbl_1_1modelling_1_1numbercounts_1_1Modelling__NumberCounts1D__Size.html" title="The class Modelling_NumberCounts1D_Size." alt="" coords="831,152,1082,193"/>
<area shape="rect" href="../../db/d78/classcbl_1_1modelling_1_1numbercounts_1_1Modelling__NumberCounts2D__RedshiftMass.html" title="The class Modelling_NumberCounts2D_RedshiftMass." alt="" coords="849,218,1065,274"/>
<area shape="rect" href="../../d3/d7f/classcbl_1_1modelling_1_1threept_1_1Modelling__ThreePointCorrelation__angular__connected.html" title="The class Modelling_ThreePointCorrelation_angular_connected." alt="" coords="534,298,777,354"/>
<area shape="rect" href="../../df/d9a/classcbl_1_1modelling_1_1threept_1_1Modelling__ThreePointCorrelation__comoving__connected.html" title="The class Modelling_ThreePointCorrelation_comoving_connected." alt="" coords="534,378,777,434"/>
<area shape="rect" href="../../dd/d32/classcbl_1_1modelling_1_1threept_1_1Modelling__ThreePointCorrelation__angular__reduced.html" title="The class Modelling_ThreePointCorrelation_angular_reduced." alt="" coords="835,298,1078,354"/>
<area shape="rect" href="../../db/d60/classcbl_1_1modelling_1_1threept_1_1Modelling__ThreePointCorrelation__comoving__reduced.html" title="The class Modelling_ThreePointCorrelation_comoving_reduced." alt="" coords="835,378,1078,434"/>
<area shape="rect" href="../../d6/d8d/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation1D.html" title="The class Modelling_TwoPointCorrelation1D." alt="" coords="531,505,780,547"/>
<area shape="rect" href="../../d5/d8f/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation2D.html" title="The class Modelling_TwoPointCorrelation2D." alt="" coords="531,625,780,667"/>
<area shape="rect" href="../../d5/dbd/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation1D__angular.html" title="The class Modelling_TwoPointCorrelation1D_angular." alt="" coords="837,458,1076,514"/>
<area shape="rect" href="../../d6/d6e/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation1D__monopole.html" title="The class Modelling_TwoPointCorrelation1D_monopole." alt="" coords="837,538,1076,594"/>
<area shape="rect" href="../../d2/d3d/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation1D__filtered.html" title="The class Modelling_TwoPointCorrelation1D_filtered." alt="" coords="1133,418,1372,474"/>
<area shape="rect" href="../../db/dc5/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation__multipoles.html" title="The class Modelling_TwoPointCorrelation_multipoles." alt="" coords="1137,498,1368,554"/>
<area shape="rect" href="../../dd/d6e/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation__projected.html" title="The class Modelling_TwoPointCorrelation_projected." alt="" coords="1137,578,1368,634"/>
<area shape="rect" href="../../d9/d7a/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation__wedges.html" title="The class Modelling_TwoPointCorrelation_wedges." alt="" coords="1137,658,1368,714"/>
<area shape="rect" href="../../da/d35/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation__deprojected.html" title="The class Modelling_TwoPointCorrelation_deprojected." alt="" coords="1420,578,1651,634"/>
<area shape="rect" href="../../d6/dc0/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation2D__cartesian.html" title="The class Modelling_TwoPointCorrelation2D_cartesian." alt="" coords="837,618,1076,674"/>
<area shape="rect" href="../../dd/dce/classcbl_1_1modelling_1_1twopt_1_1Modelling__TwoPointCorrelation2D__polar.html" title="The class Modelling_TwoPointCorrelation2D_polar." alt="" coords="837,698,1076,754"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructors/destructors</div></td></tr>
<tr class="memitem:a86cda30c39275b78769dee5f87d5a3ae"><td class="memItemLeft" align="right" valign="top"><a id="a86cda30c39275b78769dee5f87d5a3ae"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a86cda30c39275b78769dee5f87d5a3ae">Modelling</a> ()=default</td></tr>
<tr class="memdesc:a86cda30c39275b78769dee5f87d5a3ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">default constuctor <br /></td></tr>
<tr class="separator:a86cda30c39275b78769dee5f87d5a3ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab52fda14f69e5153726a316aed8dbd9"><td class="memItemLeft" align="right" valign="top"><a id="aab52fda14f69e5153726a316aed8dbd9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aab52fda14f69e5153726a316aed8dbd9">~Modelling</a> ()=default</td></tr>
<tr class="memdesc:aab52fda14f69e5153726a316aed8dbd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">default destructor <br /></td></tr>
<tr class="separator:aab52fda14f69e5153726a316aed8dbd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Member functions used to get the protected members</div></td></tr>
<tr class="memitem:a91ee86f295c8046b3ff141fb8ce6effb"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a91ee86f295c8046b3ff141fb8ce6effb">data</a> ()</td></tr>
<tr class="memdesc:a91ee86f295c8046b3ff141fb8ce6effb"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the dataset  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a91ee86f295c8046b3ff141fb8ce6effb">More...</a><br /></td></tr>
<tr class="separator:a91ee86f295c8046b3ff141fb8ce6effb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a330daeea0024b1404f4be9f5f54b6ea9"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a330daeea0024b1404f4be9f5f54b6ea9">data_fit</a> ()</td></tr>
<tr class="memdesc:a330daeea0024b1404f4be9f5f54b6ea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the dataset  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a330daeea0024b1404f4be9f5f54b6ea9">More...</a><br /></td></tr>
<tr class="separator:a330daeea0024b1404f4be9f5f54b6ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada23253dbc0a2a128e6d82df60a88082"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d1/d68/classcbl_1_1statistics_1_1Likelihood.html">statistics::Likelihood</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ada23253dbc0a2a128e6d82df60a88082">likelihood</a> ()</td></tr>
<tr class="memdesc:ada23253dbc0a2a128e6d82df60a88082"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the likelihood parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ada23253dbc0a2a128e6d82df60a88082">More...</a><br /></td></tr>
<tr class="separator:ada23253dbc0a2a128e6d82df60a88082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf69f3454bcbdb0c028d2c5da308ba69"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d0/d0a/classcbl_1_1statistics_1_1Posterior.html">statistics::Posterior</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aaf69f3454bcbdb0c028d2c5da308ba69">posterior</a> ()</td></tr>
<tr class="memdesc:aaf69f3454bcbdb0c028d2c5da308ba69"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the posterior parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aaf69f3454bcbdb0c028d2c5da308ba69">More...</a><br /></td></tr>
<tr class="separator:aaf69f3454bcbdb0c028d2c5da308ba69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7fbfe639c97153b44ccf2c686c77ce"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d6/ddb/classcbl_1_1statistics_1_1ModelParameters.html">statistics::ModelParameters</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2a7fbfe639c97153b44ccf2c686c77ce">likelihood_parameters</a> ()</td></tr>
<tr class="memdesc:a2a7fbfe639c97153b44ccf2c686c77ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the likelihood parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2a7fbfe639c97153b44ccf2c686c77ce">More...</a><br /></td></tr>
<tr class="separator:a2a7fbfe639c97153b44ccf2c686c77ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ef1457bb68947fd5bfd6a6e39bcf69"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d6/ddb/classcbl_1_1statistics_1_1ModelParameters.html">statistics::ModelParameters</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#af9ef1457bb68947fd5bfd6a6e39bcf69">posterior_parameters</a> ()</td></tr>
<tr class="memdesc:af9ef1457bb68947fd5bfd6a6e39bcf69"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the posterior parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#af9ef1457bb68947fd5bfd6a6e39bcf69">More...</a><br /></td></tr>
<tr class="separator:af9ef1457bb68947fd5bfd6a6e39bcf69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Member functions used to set internal parameters</div></td></tr>
<tr class="memitem:a2be55435176151510d8466eba3ebe148"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2be55435176151510d8466eba3ebe148">reset_fit_range</a> ()</td></tr>
<tr class="memdesc:a2be55435176151510d8466eba3ebe148"><td class="mdescLeft">&#160;</td><td class="mdescRight">reset the fit range  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2be55435176151510d8466eba3ebe148">More...</a><br /></td></tr>
<tr class="separator:a2be55435176151510d8466eba3ebe148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5cbfd5aef8588edf6afd5c827da22d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ad5cbfd5aef8588edf6afd5c827da22d5">set_fit_range</a> (const double xmin, const double xmax)</td></tr>
<tr class="memdesc:ad5cbfd5aef8588edf6afd5c827da22d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the fit range  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ad5cbfd5aef8588edf6afd5c827da22d5">More...</a><br /></td></tr>
<tr class="separator:ad5cbfd5aef8588edf6afd5c827da22d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de1409cc2364923012ede688e191d62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a8de1409cc2364923012ede688e191d62">set_fit_range</a> (const double xmin, const double xmax, const double ymin, const double ymax)</td></tr>
<tr class="memdesc:a8de1409cc2364923012ede688e191d62"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the fit range  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a8de1409cc2364923012ede688e191d62">More...</a><br /></td></tr>
<tr class="separator:a8de1409cc2364923012ede688e191d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8547d0cb8da2cbac56bc6cf19e7a49bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a8547d0cb8da2cbac56bc6cf19e7a49bb">set_data</a> (const std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt; dataset)</td></tr>
<tr class="memdesc:a8547d0cb8da2cbac56bc6cf19e7a49bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the dataset  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a8547d0cb8da2cbac56bc6cf19e7a49bb">More...</a><br /></td></tr>
<tr class="separator:a8547d0cb8da2cbac56bc6cf19e7a49bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91c33ea880d3d54a4e38b2d686082a81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a91c33ea880d3d54a4e38b2d686082a81">set_likelihood</a> (const <a class="el" href="../../de/d99/namespacecbl_1_1statistics.html#a38749ce915de37868b3dd080337fe609">statistics::LikelihoodType</a> likelihood_type, const std::vector&lt; size_t &gt; x_index={0, 2}, const int w_index=-1, const double prec=1.e-10, const int Nres=-1)</td></tr>
<tr class="memdesc:a91c33ea880d3d54a4e38b2d686082a81"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the likelihood function  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a91c33ea880d3d54a4e38b2d686082a81">More...</a><br /></td></tr>
<tr class="separator:a91c33ea880d3d54a4e38b2d686082a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Member functions used to manage likelihood/posterior</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>distributions </p>
</div></td></tr>
<tr class="memitem:a3bfa4a1a26f75c6133013f83a1d6bd0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a3bfa4a1a26f75c6133013f83a1d6bd0a">maximize_likelihood</a> (const std::vector&lt; double &gt; start, const std::vector&lt; std::vector&lt; double &gt;&gt; parameter_limits, const unsigned int max_iter=10000, const double tol=1.e-6, const double epsilon=1.e-3)</td></tr>
<tr class="memdesc:a3bfa4a1a26f75c6133013f83a1d6bd0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">function that maximizes the posterior, finds the best-fit parameters and stores them in the model  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a3bfa4a1a26f75c6133013f83a1d6bd0a">More...</a><br /></td></tr>
<tr class="separator:a3bfa4a1a26f75c6133013f83a1d6bd0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcd5acc340f0a633f9f68be84614f518"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#afcd5acc340f0a633f9f68be84614f518">maximize_posterior</a> (const std::vector&lt; double &gt; start, const unsigned int max_iter=10000, const double tol=1.e-6, const double epsilon=1.e-3, const int seed=666)</td></tr>
<tr class="memdesc:afcd5acc340f0a633f9f68be84614f518"><td class="mdescLeft">&#160;</td><td class="mdescRight">function that maximizes the posterior, finds the best-fit parameters and stores them in the model  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#afcd5acc340f0a633f9f68be84614f518">More...</a><br /></td></tr>
<tr class="separator:afcd5acc340f0a633f9f68be84614f518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab445d85cdc90a0d985f1a929b74caeea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ab445d85cdc90a0d985f1a929b74caeea">sample_posterior</a> (const int chain_size, const int nwalkers, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:ab445d85cdc90a0d985f1a929b74caeea"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains by drawing from the prior distributions  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ab445d85cdc90a0d985f1a929b74caeea">More...</a><br /></td></tr>
<tr class="separator:ab445d85cdc90a0d985f1a929b74caeea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae70e752db358077ed1e5a91668ab719f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ae70e752db358077ed1e5a91668ab719f">sample_posterior</a> (const int chain_size, const int nwalkers, const double radius, const std::vector&lt; double &gt; start, const unsigned int max_iter=10000, const double tol=1.e-6, const double epsilon=1.e-3, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:ae70e752db358077ed1e5a91668ab719f"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains in a ball around the posterior best-fit parameters values  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ae70e752db358077ed1e5a91668ab719f">More...</a><br /></td></tr>
<tr class="separator:ae70e752db358077ed1e5a91668ab719f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d4f131007a7f5b2b6055f50f72747a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a16d4f131007a7f5b2b6055f50f72747a">sample_posterior</a> (const int chain_size, const int nwalkers, std::vector&lt; double &gt; &amp;value, const double radius, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a16d4f131007a7f5b2b6055f50f72747a"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains by drawing from the prior distributions  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a16d4f131007a7f5b2b6055f50f72747a">More...</a><br /></td></tr>
<tr class="separator:a16d4f131007a7f5b2b6055f50f72747a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a235f03023183ac37ebb201be362abe63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a235f03023183ac37ebb201be362abe63">sample_posterior</a> (const int chain_size, const std::vector&lt; std::vector&lt; double &gt;&gt; chain_value, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a235f03023183ac37ebb201be362abe63"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains with input values  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a235f03023183ac37ebb201be362abe63">More...</a><br /></td></tr>
<tr class="separator:a235f03023183ac37ebb201be362abe63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c661eca5cd2909dd1f303fa20dafd8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4c661eca5cd2909dd1f303fa20dafd8f">sample_posterior</a> (const int chain_size, const int nwalkers, const std::string input_dir, const std::string input_file, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a4c661eca5cd2909dd1f303fa20dafd8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains reading the input values from an input file  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4c661eca5cd2909dd1f303fa20dafd8f">More...</a><br /></td></tr>
<tr class="separator:a4c661eca5cd2909dd1f303fa20dafd8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a268d877709d3bce4f4477d054bfc1ec6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a268d877709d3bce4f4477d054bfc1ec6">importance_sampling</a> (const std::string input_dir, const std::string input_file, const int seed=666, const std::vector&lt; size_t &gt; column={}, const int header_lines_to_skip=1, const bool is_FITS_format=false, const bool apply_to_likelihood=false)</td></tr>
<tr class="memdesc:a268d877709d3bce4f4477d054bfc1ec6"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform importance sampling  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a268d877709d3bce4f4477d054bfc1ec6">More...</a><br /></td></tr>
<tr class="separator:a268d877709d3bce4f4477d054bfc1ec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Member functions used for Input/Output</div></td></tr>
<tr class="memitem:a45480d79ce4c73c99690029c47bc36aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a45480d79ce4c73c99690029c47bc36aa">write_chain</a> (const std::string output_dir, const std::string output_file, const int start=0, const int thin=1, const bool is_FITS_format=false, const int prec=5, const int ww=14)</td></tr>
<tr class="memdesc:a45480d79ce4c73c99690029c47bc36aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the chains obtained after the MCMC sampling  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a45480d79ce4c73c99690029c47bc36aa">More...</a><br /></td></tr>
<tr class="separator:a45480d79ce4c73c99690029c47bc36aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673765574ab67435911ea251ad0ab954"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a673765574ab67435911ea251ad0ab954">read_chain</a> (const std::string input_dir, const std::string input_file, const int nwalkers, const std::vector&lt; size_t &gt; columns={}, const int skip_header=1, const bool fits=false)</td></tr>
<tr class="memdesc:a673765574ab67435911ea251ad0ab954"><td class="mdescLeft">&#160;</td><td class="mdescRight">read the chains  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a673765574ab67435911ea251ad0ab954">More...</a><br /></td></tr>
<tr class="separator:a673765574ab67435911ea251ad0ab954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e99a06a0ec551ff4f4c77d3ff03366"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a58e99a06a0ec551ff4f4c77d3ff03366">show_results</a> (const int start=0, const int thin=1, const int nbins=50, const bool show_mode=false, const int ns=-1)</td></tr>
<tr class="memdesc:a58e99a06a0ec551ff4f4c77d3ff03366"><td class="mdescLeft">&#160;</td><td class="mdescRight">show the results of the MCMC sampling on screen  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a58e99a06a0ec551ff4f4c77d3ff03366">More...</a><br /></td></tr>
<tr class="separator:a58e99a06a0ec551ff4f4c77d3ff03366"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0487a258098b3d434f9a77f8ad2a1971"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a0487a258098b3d434f9a77f8ad2a1971">write_results</a> (const std::string output_dir, const std::string root_file, const int start=0, const int thin=1, const int nbins=50, const bool fits=false, const bool compute_mode=false, const int ns=-1)</td></tr>
<tr class="memdesc:a0487a258098b3d434f9a77f8ad2a1971"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the results of the MCMC sampling to file  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a0487a258098b3d434f9a77f8ad2a1971">More...</a><br /></td></tr>
<tr class="separator:a0487a258098b3d434f9a77f8ad2a1971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7775893be4bd28e20cf75c85d5da009f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a7775893be4bd28e20cf75c85d5da009f">write_model</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const std::vector&lt; double &gt; parameters)</td></tr>
<tr class="memdesc:a7775893be4bd28e20cf75c85d5da009f"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx for given parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a7775893be4bd28e20cf75c85d5da009f">More...</a><br /></td></tr>
<tr class="separator:a7775893be4bd28e20cf75c85d5da009f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4858755764d9acc999c61272eff73916"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4858755764d9acc999c61272eff73916">write_model</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const std::vector&lt; double &gt; yy, const std::vector&lt; double &gt; parameters)</td></tr>
<tr class="memdesc:a4858755764d9acc999c61272eff73916"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx, yy for given parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4858755764d9acc999c61272eff73916">More...</a><br /></td></tr>
<tr class="separator:a4858755764d9acc999c61272eff73916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefde83b30fd4dd99a0042e821c31e36d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aefde83b30fd4dd99a0042e821c31e36d">write_model_at_bestfit</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx)</td></tr>
<tr class="memdesc:aefde83b30fd4dd99a0042e821c31e36d"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx with best-fit parameters obtained from posterior maximization  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aefde83b30fd4dd99a0042e821c31e36d">More...</a><br /></td></tr>
<tr class="separator:aefde83b30fd4dd99a0042e821c31e36d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0da5b6953bd3ef3039005b12027501"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aec0da5b6953bd3ef3039005b12027501">write_model_at_bestfit</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const std::vector&lt; double &gt; yy)</td></tr>
<tr class="memdesc:aec0da5b6953bd3ef3039005b12027501"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx, yy with best-fit parameters obtained from likelihood maximization  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aec0da5b6953bd3ef3039005b12027501">More...</a><br /></td></tr>
<tr class="separator:aec0da5b6953bd3ef3039005b12027501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ad5f68641af6da97e8c6702965698a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a67ad5f68641af6da97e8c6702965698a">write_model_from_chains</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const int start=0, const int thin=1)</td></tr>
<tr class="memdesc:a67ad5f68641af6da97e8c6702965698a"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx computing 16th, 50th and 84th percentiles from the chains  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a67ad5f68641af6da97e8c6702965698a">More...</a><br /></td></tr>
<tr class="separator:a67ad5f68641af6da97e8c6702965698a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a3663b17bad9b29ba04641277c92b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a77a3663b17bad9b29ba04641277c92b2">write_model_from_chains</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const std::vector&lt; double &gt; yy, const int start=0, const int thin=1)</td></tr>
<tr class="memdesc:a77a3663b17bad9b29ba04641277c92b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx, yy computing 16th, 50th and 84th percentiles from the chains  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a77a3663b17bad9b29ba04641277c92b2">More...</a><br /></td></tr>
<tr class="separator:a77a3663b17bad9b29ba04641277c92b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a478a15996b663ed9714d966ed325917f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a478a15996b663ed9714d966ed325917f">m_set_prior</a> (std::vector&lt; <a class="el" href="../../d7/d79/classcbl_1_1statistics_1_1PriorDistribution.html">statistics::PriorDistribution</a> &gt; prior_distribution)</td></tr>
<tr class="memdesc:a478a15996b663ed9714d966ed325917f"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the interal variable m_parameter_priors  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a478a15996b663ed9714d966ed325917f">More...</a><br /></td></tr>
<tr class="separator:a478a15996b663ed9714d966ed325917f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794eaee60fed0c6340b3c0a5ab0d9c87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a794eaee60fed0c6340b3c0a5ab0d9c87">m_set_posterior</a> (const int seed)</td></tr>
<tr class="memdesc:a794eaee60fed0c6340b3c0a5ab0d9c87"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the interal variable m_posterior  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a794eaee60fed0c6340b3c0a5ab0d9c87">More...</a><br /></td></tr>
<tr class="separator:a794eaee60fed0c6340b3c0a5ab0d9c87"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a2f188e53e2cff3cf3cee94a0c7b0c0b0"><td class="memItemLeft" align="right" valign="top"><a id="a2f188e53e2cff3cf3cee94a0c7b0c0b0"></a>
std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2f188e53e2cff3cf3cee94a0c7b0c0b0">m_data</a> = NULL</td></tr>
<tr class="memdesc:a2f188e53e2cff3cf3cee94a0c7b0c0b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">input data to be modelled <br /></td></tr>
<tr class="separator:a2f188e53e2cff3cf3cee94a0c7b0c0b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a125242587d7dd812e3c80b7a03234055"><td class="memItemLeft" align="right" valign="top"><a id="a125242587d7dd812e3c80b7a03234055"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a125242587d7dd812e3c80b7a03234055">m_fit_range</a> = false</td></tr>
<tr class="memdesc:a125242587d7dd812e3c80b7a03234055"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if fit range has been set <br /></td></tr>
<tr class="separator:a125242587d7dd812e3c80b7a03234055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae184e3332f742c7dc18ea4112fe0ef5d"><td class="memItemLeft" align="right" valign="top"><a id="ae184e3332f742c7dc18ea4112fe0ef5d"></a>
std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ae184e3332f742c7dc18ea4112fe0ef5d">m_data_fit</a></td></tr>
<tr class="memdesc:ae184e3332f742c7dc18ea4112fe0ef5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">input data restricted to the range used for the fit <br /></td></tr>
<tr class="separator:ae184e3332f742c7dc18ea4112fe0ef5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae945eb8214037f249dee1a4283173821"><td class="memItemLeft" align="right" valign="top"><a id="ae945eb8214037f249dee1a4283173821"></a>
std::shared_ptr&lt; <a class="el" href="../../d0/da1/classcbl_1_1statistics_1_1Model.html">statistics::Model</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ae945eb8214037f249dee1a4283173821">m_model</a> = NULL</td></tr>
<tr class="memdesc:ae945eb8214037f249dee1a4283173821"><td class="mdescLeft">&#160;</td><td class="mdescRight">input model <br /></td></tr>
<tr class="separator:ae945eb8214037f249dee1a4283173821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b9f7d0422248cb12bc77329d0e57ec4"><td class="memItemLeft" align="right" valign="top"><a id="a5b9f7d0422248cb12bc77329d0e57ec4"></a>
std::shared_ptr&lt; <a class="el" href="../../d1/d68/classcbl_1_1statistics_1_1Likelihood.html">statistics::Likelihood</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a5b9f7d0422248cb12bc77329d0e57ec4">m_likelihood</a> = NULL</td></tr>
<tr class="memdesc:a5b9f7d0422248cb12bc77329d0e57ec4"><td class="mdescLeft">&#160;</td><td class="mdescRight">likelihood <br /></td></tr>
<tr class="separator:a5b9f7d0422248cb12bc77329d0e57ec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4938c3d2de13efabf2709d6ff8de9412"><td class="memItemLeft" align="right" valign="top"><a id="a4938c3d2de13efabf2709d6ff8de9412"></a>
std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../d7/d79/classcbl_1_1statistics_1_1PriorDistribution.html">statistics::PriorDistribution</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4938c3d2de13efabf2709d6ff8de9412">m_parameter_priors</a></td></tr>
<tr class="memdesc:a4938c3d2de13efabf2709d6ff8de9412"><td class="mdescLeft">&#160;</td><td class="mdescRight">prior <br /></td></tr>
<tr class="separator:a4938c3d2de13efabf2709d6ff8de9412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a08e71b68b4c0e56f15328415887f24"><td class="memItemLeft" align="right" valign="top"><a id="a5a08e71b68b4c0e56f15328415887f24"></a>
std::shared_ptr&lt; <a class="el" href="../../d0/d0a/classcbl_1_1statistics_1_1Posterior.html">statistics::Posterior</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a5a08e71b68b4c0e56f15328415887f24">m_posterior</a> = NULL</td></tr>
<tr class="memdesc:a5a08e71b68b4c0e56f15328415887f24"><td class="mdescLeft">&#160;</td><td class="mdescRight">posterior <br /></td></tr>
<tr class="separator:a5a08e71b68b4c0e56f15328415887f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The class <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html" title="The class Modelling.">Modelling</a>. </p>
<p>This file defines the interface of the base class <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html" title="The class Modelling.">Modelling</a>, used for modelling any kind of measurements </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d4c/Modelling_8h_source.html#l00064">64</a> of file <a class="el" href="../../d5/d4c/Modelling_8h_source.html">Modelling.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a91ee86f295c8046b3ff141fb8ce6effb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91ee86f295c8046b3ff141fb8ce6effb">&#9670;&nbsp;</a></span>data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a>&gt; cbl::modelling::Modelling::data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return the dataset </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the current dataset </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d4c/Modelling_8h_source.html#l00135">135</a> of file <a class="el" href="../../d5/d4c/Modelling_8h_source.html">Modelling.h</a>.</p>

</div>
</div>
<a id="a330daeea0024b1404f4be9f5f54b6ea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a330daeea0024b1404f4be9f5f54b6ea9">&#9670;&nbsp;</a></span>data_fit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a>&gt; cbl::modelling::Modelling::data_fit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return the dataset </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the current dataset </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d4c/Modelling_8h_source.html#l00141">141</a> of file <a class="el" href="../../d5/d4c/Modelling_8h_source.html">Modelling.h</a>.</p>

</div>
</div>
<a id="a268d877709d3bce4f4477d054bfc1ec6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a268d877709d3bce4f4477d054bfc1ec6">&#9670;&nbsp;</a></span>importance_sampling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::importance_sampling </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>666</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; size_t &gt;&#160;</td>
          <td class="paramname"><em>column</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>header_lines_to_skip</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_FITS_format</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>apply_to_likelihood</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>perform importance sampling </p>
<p>Importance sampling is a convenient technique to join independet datasets.</p>
<p>This function takes in input a chain and computes the likelihood or posterior looping over all entries. It's possible to specify the columns, in case the input chain has different ordering, or larger number of parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_dir</td><td>input directory</td></tr>
    <tr><td class="paramname">input_file</td><td>the input file</td></tr>
    <tr><td class="paramname">seed</td><td>the seed</td></tr>
    <tr><td class="paramname">column</td><td>the columns of the input file to be read</td></tr>
    <tr><td class="paramname">header_lines_to_skip</td><td>the lines to be skipped in the chain file</td></tr>
    <tr><td class="paramname">is_FITS_format</td><td>true \(\rightarrow\) the format of the input file is FITS; false \(\rightarrow\) the format of the input file is ASCII</td></tr>
    <tr><td class="paramname">apply_to_likelihood</td><td>true \(\rightarrow\) the likelihood ratio is used as weight; false \(\rightarrow\) the posterior ratio is used as weight</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>column is used only for ASCII chain files </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00216">216</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="ada23253dbc0a2a128e6d82df60a88082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada23253dbc0a2a128e6d82df60a88082">&#9670;&nbsp;</a></span>likelihood()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">shared_ptr&lt; <a class="el" href="../../d1/d68/classcbl_1_1statistics_1_1Likelihood.html">statistics::Likelihood</a> &gt; cbl::modelling::Modelling::likelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return the likelihood parameters </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the likelihood parameters </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00070">70</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a2a7fbfe639c97153b44ccf2c686c77ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a7fbfe639c97153b44ccf2c686c77ce">&#9670;&nbsp;</a></span>likelihood_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">shared_ptr&lt; <a class="el" href="../../d6/ddb/classcbl_1_1statistics_1_1ModelParameters.html">cbl::statistics::ModelParameters</a> &gt; cbl::modelling::Modelling::likelihood_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return the likelihood parameters </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the likelihood parameters </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00096">96</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a794eaee60fed0c6340b3c0a5ab0d9c87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a794eaee60fed0c6340b3c0a5ab0d9c87">&#9670;&nbsp;</a></span>m_set_posterior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::m_set_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the interal variable m_posterior </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seed</td><td>the seed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00058">58</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a478a15996b663ed9714d966ed325917f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a478a15996b663ed9714d966ed325917f">&#9670;&nbsp;</a></span>m_set_prior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::m_set_prior </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d7/d79/classcbl_1_1statistics_1_1PriorDistribution.html">statistics::PriorDistribution</a> &gt;&#160;</td>
          <td class="paramname"><em>prior_distribution</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the interal variable m_parameter_priors </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prior_distribution</td><td>vector containing the prior distributions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00046">46</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a3bfa4a1a26f75c6133013f83a1d6bd0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bfa4a1a26f75c6133013f83a1d6bd0a">&#9670;&nbsp;</a></span>maximize_likelihood()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::maximize_likelihood </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt;&#160;</td>
          <td class="paramname"><em>parameter_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>10000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1.e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1.e-3</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>function that maximizes the posterior, finds the best-fit parameters and stores them in the model </p>
<p>this function exploits the Nelder-Mead method <a href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method</a></p>
<p>the algorithm defines a simplex (i.e a k-dimensional polytope which is the convex hull of its k+1 vertices) in the parameter space. At each step, it identifies the simplex vertex at which the function to be minimised (i.e. the negative likelihood in this case) has the greatest value, and moves it, via reflections and scaling, to a new position in which the function has a lower value. This iteration stops when the simplex area becomes lower than the tolerance. For instance, in 2D, the starting vertices of the simplex (a triangle in 2D) are the following: (start[0], start[1]) ; (start[0]+epsilon, start[1]) ; (start[0], start[1]+epsilon)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start</td><td>std::vector containing the initial values for the likelihood maximization</td></tr>
    <tr><td class="paramname">parameter_limits</td><td>limits of the parameter space in where the maximum of likelihood will be searched</td></tr>
    <tr><td class="paramname">max_iter</td><td>the maximum number of iterations</td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance in finding convergence</td></tr>
    <tr><td class="paramname">epsilon</td><td>the simplex side </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00144">144</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="afcd5acc340f0a633f9f68be84614f518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcd5acc340f0a633f9f68be84614f518">&#9670;&nbsp;</a></span>maximize_posterior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::maximize_posterior </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>10000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1.e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1.e-3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>666</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>function that maximizes the posterior, finds the best-fit parameters and stores them in the model </p>
<p>this function exploits the Nelder-Mead method <a href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method</a></p>
<p>the algorithm defines a simplex (i.e a k-dimensional polytope which is the convex hull of its k+1 vertices) in the parameter space. At each step, it identifies the simplex vertex at which the function to be minimised (i.e. the negative posterior in this case) has the greatest value, and moves it, via reflections and scaling, to a new position in which the function has a lower value. This iteration stops when the simplex area becomes lower than the tolerance. For instance, in 2D, the starting vertices of the simplex (a triangle in 2D) are the following: (start[0], start[1]) ; (start[0]+epsilon, start[1]) ; (start[0], start[1]+epsilon)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start</td><td>vector containing initial values for the posterior maximization</td></tr>
    <tr><td class="paramname">max_iter</td><td>the maximum number of iterations</td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance to find convergence</td></tr>
    <tr><td class="paramname">epsilon</td><td>the relative fraction of the initial simplex size</td></tr>
    <tr><td class="paramname">seed</td><td>the seed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d4/db0/model_2pt_monopole_RSD_8cpp-example.html#a20">model_2pt_monopole_RSD.cpp</a>, <a class="el" href="../../d7/d8f/model_2pt_multipoles_8cpp-example.html#a20">model_2pt_multipoles.cpp</a>, and <a class="el" href="../../d4/d2e/modelling_VoidAbundances_8cpp-example.html#a26">modelling_VoidAbundances.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00153">153</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="aaf69f3454bcbdb0c028d2c5da308ba69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf69f3454bcbdb0c028d2c5da308ba69">&#9670;&nbsp;</a></span>posterior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">shared_ptr&lt; <a class="el" href="../../d0/d0a/classcbl_1_1statistics_1_1Posterior.html">cbl::statistics::Posterior</a> &gt; cbl::modelling::Modelling::posterior </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return the posterior parameters </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the posterior parameters </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d7/d8f/model_2pt_multipoles_8cpp-example.html#a21">model_2pt_multipoles.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00083">83</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="af9ef1457bb68947fd5bfd6a6e39bcf69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ef1457bb68947fd5bfd6a6e39bcf69">&#9670;&nbsp;</a></span>posterior_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">shared_ptr&lt; <a class="el" href="../../d6/ddb/classcbl_1_1statistics_1_1ModelParameters.html">cbl::statistics::ModelParameters</a> &gt; cbl::modelling::Modelling::posterior_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return the posterior parameters </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the posterior parameters </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00109">109</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a673765574ab67435911ea251ad0ab954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a673765574ab67435911ea251ad0ab954">&#9670;&nbsp;</a></span>read_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::read_chain </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; size_t &gt;&#160;</td>
          <td class="paramname"><em>columns</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>skip_header</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>fits</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read the chains </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_dir</td><td>the input directory</td></tr>
    <tr><td class="paramname">input_file</td><td>the input file</td></tr>
    <tr><td class="paramname">nwalkers</td><td>the number of parallel chains</td></tr>
    <tr><td class="paramname">columns</td><td>the columns of the input file to be read.</td></tr>
    <tr><td class="paramname">skip_header</td><td>the lines to be skipped in the chain file</td></tr>
    <tr><td class="paramname">fits</td><td>false \(\rightarrow\) ascii file; true \(\rightarrow\) fits file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00235">235</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a2be55435176151510d8466eba3ebe148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be55435176151510d8466eba3ebe148">&#9670;&nbsp;</a></span>reset_fit_range()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::reset_fit_range </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>reset the fit range </p>
<p>set m_fit_range = false, that means that the fit range is unset </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d4c/Modelling_8h_source.html#l00187">187</a> of file <a class="el" href="../../d5/d4c/Modelling_8h_source.html">Modelling.h</a>.</p>

</div>
</div>
<a id="ae70e752db358077ed1e5a91668ab719f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae70e752db358077ed1e5a91668ab719f">&#9670;&nbsp;</a></span>sample_posterior() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::sample_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>chain_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>10000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1.e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1.e-3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>666</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>aa</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sample the posterior, initializing the chains in a ball around the posterior best-fit parameters values </p>
<p>the starting values of the chain are extracted from uniform distributions in the range [parameter-radius, parameter+radius] (for each likelihood parameter)</p>
<p>this function first maximizes the posterior, starting the computation at the values of the input vector 'start', then it inizializes the chain</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_size</td><td>the chain lenght</td></tr>
    <tr><td class="paramname">nwalkers</td><td>the number of parallel chains</td></tr>
    <tr><td class="paramname">radius</td><td>radius of the ball in parameter space</td></tr>
    <tr><td class="paramname">start</td><td>std::vector containing initial values for the posterior maximization</td></tr>
    <tr><td class="paramname">max_iter</td><td>the maximum number of iterations</td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance in finding convergence</td></tr>
    <tr><td class="paramname">epsilon</td><td>the simplex side</td></tr>
    <tr><td class="paramname">seed</td><td>the seed</td></tr>
    <tr><td class="paramname">aa</td><td>the parameter of the \(g(z)\) distribution</td></tr>
    <tr><td class="paramname">parallel</td><td>false \(\rightarrow\) non-parallel sampler; true \(\rightarrow\) parallel sampler </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00173">173</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="ab445d85cdc90a0d985f1a929b74caeea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab445d85cdc90a0d985f1a929b74caeea">&#9670;&nbsp;</a></span>sample_posterior() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::sample_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>chain_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>666</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>aa</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sample the posterior, initializing the chains by drawing from the prior distributions </p>
<p>the starting values of the chain are extracted from the (possibly different) distributions of the priors</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_size</td><td>the chain lenght</td></tr>
    <tr><td class="paramname">nwalkers</td><td>the number of parallel chains</td></tr>
    <tr><td class="paramname">seed</td><td>the seed</td></tr>
    <tr><td class="paramname">aa</td><td>the parameter of the \(g(z)\) distribution</td></tr>
    <tr><td class="paramname">parallel</td><td>false \(\rightarrow\) non-parallel sampler; true \(\rightarrow\) parallel sampler </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d7/d86/model_2pt_2D_8cpp-example.html#a22">model_2pt_2D.cpp</a>, <a class="el" href="../../dc/d7d/model_2pt_monopole_BAO_8cpp-example.html#a18">model_2pt_monopole_BAO.cpp</a>, <a class="el" href="../../d4/db0/model_2pt_monopole_RSD_8cpp-example.html#a21">model_2pt_monopole_RSD.cpp</a>, <a class="el" href="../../dd/d01/model_2pt_projected_8cpp-example.html#a19">model_2pt_projected.cpp</a>, <a class="el" href="../../df/dbb/model_3pt_8cpp-example.html#a20">model_3pt.cpp</a>, and <a class="el" href="../../d5/def/model_cosmology_8cpp-example.html#a16">model_cosmology.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00163">163</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a4c661eca5cd2909dd1f303fa20dafd8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c661eca5cd2909dd1f303fa20dafd8f">&#9670;&nbsp;</a></span>sample_posterior() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::sample_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>chain_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>666</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>aa</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sample the posterior, initializing the chains reading the input values from an input file </p>
<p>the starting values of the chain are get from the last lines of an input chain file; it can be used to continue an MCMC sampling computation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_size</td><td>the chain lenght</td></tr>
    <tr><td class="paramname">nwalkers</td><td>the number of parallel chains</td></tr>
    <tr><td class="paramname">input_dir</td><td>input directory</td></tr>
    <tr><td class="paramname">input_file</td><td>the input file</td></tr>
    <tr><td class="paramname">seed</td><td>the seed</td></tr>
    <tr><td class="paramname">aa</td><td>the parameter of the \(g(z)\) distribution</td></tr>
    <tr><td class="paramname">parallel</td><td>false \(\rightarrow\) non-parallel sampler; true \(\rightarrow\) parallel sampler </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00205">205</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a16d4f131007a7f5b2b6055f50f72747a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d4f131007a7f5b2b6055f50f72747a">&#9670;&nbsp;</a></span>sample_posterior() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::sample_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>chain_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>666</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>aa</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sample the posterior, initializing the chains by drawing from the prior distributions </p>
<p>the starting values of the chain are extracted from the (possibly different) distributions of the priors</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_size</td><td>the chain lenght</td></tr>
    <tr><td class="paramname">nwalkers</td><td>the number of parallel chains</td></tr>
    <tr><td class="paramname">value</td><td>input values, center of the ball in parameter space</td></tr>
    <tr><td class="paramname">radius</td><td>radius of the ball in parameter space</td></tr>
    <tr><td class="paramname">seed</td><td>the seed</td></tr>
    <tr><td class="paramname">aa</td><td>the parameter of the \(g(z)\) distribution</td></tr>
    <tr><td class="paramname">parallel</td><td>false \(\rightarrow\) non-parallel sampler; true \(\rightarrow\) parallel sampler </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00183">183</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a235f03023183ac37ebb201be362abe63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a235f03023183ac37ebb201be362abe63">&#9670;&nbsp;</a></span>sample_posterior() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::sample_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>chain_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt;&#160;</td>
          <td class="paramname"><em>chain_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em> = <code>666</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>aa</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sample the posterior, initializing the chains with input values </p>
<p>the starting values of the chain are the elements of the input matrix 'chain_values'</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_size</td><td>the chain lenght</td></tr>
    <tr><td class="paramname">chain_value</td><td>std::vector of size (nwalkers, nparameters) starting values of the chain</td></tr>
    <tr><td class="paramname">seed</td><td>the seed</td></tr>
    <tr><td class="paramname">aa</td><td>the parameter of the \(g(z)\) distribution</td></tr>
    <tr><td class="paramname">parallel</td><td>false \(\rightarrow\) non-parallel sampler; true \(\rightarrow\) parallel sampler </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00194">194</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a8547d0cb8da2cbac56bc6cf19e7a49bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8547d0cb8da2cbac56bc6cf19e7a49bb">&#9670;&nbsp;</a></span>set_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::set_data </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td>
          <td class="paramname"><em>dataset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the dataset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dataset</td><td>the dataset </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d5/d4c/Modelling_8h_source.html#l00216">216</a> of file <a class="el" href="../../d5/d4c/Modelling_8h_source.html">Modelling.h</a>.</p>

</div>
</div>
<a id="ad5cbfd5aef8588edf6afd5c827da22d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5cbfd5aef8588edf6afd5c827da22d5">&#9670;&nbsp;</a></span>set_fit_range() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::set_fit_range </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>xmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set the fit range </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xmin</td><td>minimum x value used for the fit</td></tr>
    <tr><td class="paramname">xmax</td><td>maximum x value used for the fit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d7/d86/model_2pt_2D_8cpp-example.html#a19">model_2pt_2D.cpp</a>, <a class="el" href="../../dc/d7d/model_2pt_monopole_BAO_8cpp-example.html#a15">model_2pt_monopole_BAO.cpp</a>, <a class="el" href="../../d4/db0/model_2pt_monopole_RSD_8cpp-example.html#a17">model_2pt_monopole_RSD.cpp</a>, <a class="el" href="../../dd/d01/model_2pt_projected_8cpp-example.html#a16">model_2pt_projected.cpp</a>, <a class="el" href="../../df/dbb/model_3pt_8cpp-example.html#a17">model_3pt.cpp</a>, and <a class="el" href="../../d5/def/model_cosmology_8cpp-example.html#a17">model_cosmology.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html#l00046">46</a> of file <a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html">Modelling1D.cpp</a>.</p>

</div>
</div>
<a id="a8de1409cc2364923012ede688e191d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8de1409cc2364923012ede688e191d62">&#9670;&nbsp;</a></span>set_fit_range() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::set_fit_range </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>ymin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>ymax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set the fit range </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xmin</td><td>minimum x value used for the fit</td></tr>
    <tr><td class="paramname">xmax</td><td>maximum x value used for the fit</td></tr>
    <tr><td class="paramname">ymin</td><td>minimum y value used for the fit</td></tr>
    <tr><td class="paramname">ymax</td><td>maximum y value used for the fit </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/db3/Modelling2D_8cpp_source.html#l00045">45</a> of file <a class="el" href="../../df/db3/Modelling2D_8cpp_source.html">Modelling2D.cpp</a>.</p>

</div>
</div>
<a id="a91c33ea880d3d54a4e38b2d686082a81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91c33ea880d3d54a4e38b2d686082a81">&#9670;&nbsp;</a></span>set_likelihood()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::set_likelihood </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d99/namespacecbl_1_1statistics.html#a38749ce915de37868b3dd080337fe609">statistics::LikelihoodType</a>&#160;</td>
          <td class="paramname"><em>likelihood_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; size_t &gt;&#160;</td>
          <td class="paramname"><em>x_index</em> = <code>{0,&#160;2}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>w_index</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>prec</em> = <code>1.e-10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nres</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set the likelihood function </p>
<p>if the input parameter Nres is larger than 0, the inverted covariance matrix is corrected as follows (Hartlap, Simon and Schneider 2006):</p>
<p class="formulaDsp">
\[ \hat{C}^{-1} = \left(1-\frac{n_b+1}{N_{res}-1}\right)C^{-1} \]
</p>
<p>where \(n_b\) is the number of bins and \(N_{res}\) is the number of resamplings</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">likelihood_type</td><td>the likelihood type, specified with the LikelihoodType object</td></tr>
    <tr><td class="paramname">x_index</td><td>index(s) of the extra info std::vector containing the point(s) where to evaluate the model</td></tr>
    <tr><td class="paramname">w_index</td><td>index of the extra info std::vector containing the data point weight</td></tr>
    <tr><td class="paramname">prec</td><td>the precision required in the inversion of the covariance matrix</td></tr>
    <tr><td class="paramname">Nres</td><td>\(N_{res}\), the number of catalogue resamplings used to estimate the covariance matrix; \(N_{res}=-1\) if the covariance matrix has not been estimated with resampling methods </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d7/d86/model_2pt_2D_8cpp-example.html#a20">model_2pt_2D.cpp</a>, <a class="el" href="../../dc/d7d/model_2pt_monopole_BAO_8cpp-example.html#a16">model_2pt_monopole_BAO.cpp</a>, <a class="el" href="../../d4/db0/model_2pt_monopole_RSD_8cpp-example.html#a18">model_2pt_monopole_RSD.cpp</a>, <a class="el" href="../../d7/d8f/model_2pt_multipoles_8cpp-example.html#a18">model_2pt_multipoles.cpp</a>, <a class="el" href="../../dd/d01/model_2pt_projected_8cpp-example.html#a17">model_2pt_projected.cpp</a>, <a class="el" href="../../df/dbb/model_3pt_8cpp-example.html#a18">model_3pt.cpp</a>, <a class="el" href="../../d5/def/model_cosmology_8cpp-example.html#a14">model_cosmology.cpp</a>, and <a class="el" href="../../d4/d2e/modelling_VoidAbundances_8cpp-example.html#a24">modelling_VoidAbundances.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00122">122</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a58e99a06a0ec551ff4f4c77d3ff03366"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e99a06a0ec551ff4f4c77d3ff03366">&#9670;&nbsp;</a></span>show_results()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::show_results </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>thin</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nbins</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>show_mode</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ns</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>show the results of the MCMC sampling on screen </p>
<p>if the covariance matrix has been estimated from a set of mock catalogues, and the input parameters ns ( \(n_s\), the number of samples used to estimate the covariance matrix) is provided (&gt;0), then the parameter errors ( \(\sigma_p\)) will be corrected to take into account the uncertainities in the covariance estimate (Percival et al. 2014):</p>
<p class="formulaDsp">
\[ \sigma_p = \sqrt{\frac{1+B(n_b-n_p)}{1+A+B(n_p+1)}} \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ A = \frac{2}{(n_s-n_b-1)(n_s-n_b-4)} \,, \]
</p>
<p class="formulaDsp">
\[ B = \frac{(n_s-n_b-2)}{(n_s-n_b-1)(n_s-n_b-4)} \,, \]
</p>
<p>where \(n_b\) is number of data measurements (e.g. the bins of the dataset).</p>
<p>This correction can be applied only if the likelihood is Gaussian. Morever, the inverce covariance matrix estimator has to be corrected to take into account the inverse Wishart distribution (Hartlap, Simon and Schneider 2006).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start</td><td>the minimum chain position to be written</td></tr>
    <tr><td class="paramname">thin</td><td>the step used for dilution on screen</td></tr>
    <tr><td class="paramname">nbins</td><td>the number of bins</td></tr>
    <tr><td class="paramname">show_mode</td><td>true \(\rightarrow\) show the posterior mode; false \(\rightarrow\) do not show the posterior mode</td></tr>
    <tr><td class="paramname">ns</td><td>number of samples used to estimate the covariance matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d7/d86/model_2pt_2D_8cpp-example.html#a23">model_2pt_2D.cpp</a>, <a class="el" href="../../dc/d7d/model_2pt_monopole_BAO_8cpp-example.html#a19">model_2pt_monopole_BAO.cpp</a>, <a class="el" href="../../d4/db0/model_2pt_monopole_RSD_8cpp-example.html#a22">model_2pt_monopole_RSD.cpp</a>, <a class="el" href="../../dd/d01/model_2pt_projected_8cpp-example.html#a20">model_2pt_projected.cpp</a>, <a class="el" href="../../df/dbb/model_3pt_8cpp-example.html#a21">model_3pt.cpp</a>, and <a class="el" href="../../d5/def/model_cosmology_8cpp-example.html#a20">model_cosmology.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00245">245</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a45480d79ce4c73c99690029c47bc36aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45480d79ce4c73c99690029c47bc36aa">&#9670;&nbsp;</a></span>write_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::write_chain </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>thin</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_FITS_format</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>prec</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ww</em> = <code>14</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the chains obtained after the MCMC sampling </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output directory</td></tr>
    <tr><td class="paramname">output_file</td><td>the output file</td></tr>
    <tr><td class="paramname">start</td><td>the minimum chain position to be written</td></tr>
    <tr><td class="paramname">thin</td><td>the step used for dilution</td></tr>
    <tr><td class="paramname">is_FITS_format</td><td>true \(\rightarrow\) the format of the input file is FITS; false \(\rightarrow\) the format of the input file is ASCII</td></tr>
    <tr><td class="paramname">prec</td><td>decimal precision</td></tr>
    <tr><td class="paramname">ww</td><td>number of characters to be used as field width </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d7/d86/model_2pt_2D_8cpp-example.html#a24">model_2pt_2D.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00226">226</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<a id="a7775893be4bd28e20cf75c85d5da009f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7775893be4bd28e20cf75c85d5da009f">&#9670;&nbsp;</a></span>write_model() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::write_model </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>parameters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the model at xx for given parameters </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output directory</td></tr>
    <tr><td class="paramname">output_file</td><td>the output file</td></tr>
    <tr><td class="paramname">xx</td><td>vector of points at which the model is computed,</td></tr>
    <tr><td class="paramname">parameters</td><td>vector containing the input parameters used to compute the model; if this vector is not provided, the model will be computed using the best-fit parameters </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html#l00056">56</a> of file <a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html">Modelling1D.cpp</a>.</p>

</div>
</div>
<a id="a4858755764d9acc999c61272eff73916"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4858755764d9acc999c61272eff73916">&#9670;&nbsp;</a></span>write_model() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::write_model </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>yy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>parameters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the model at xx, yy for given parameters </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output directory</td></tr>
    <tr><td class="paramname">output_file</td><td>the output file</td></tr>
    <tr><td class="paramname">xx</td><td>vector of points at which the model is computed, first axis</td></tr>
    <tr><td class="paramname">yy</td><td>vector of points at which the model is computed, second axis</td></tr>
    <tr><td class="paramname">parameters</td><td>vector containing the input parameters used to compute the model; if this vector is not provided, the model will be computed using the best-fit parameters </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/db3/Modelling2D_8cpp_source.html#l00054">54</a> of file <a class="el" href="../../df/db3/Modelling2D_8cpp_source.html">Modelling2D.cpp</a>.</p>

</div>
</div>
<a id="aefde83b30fd4dd99a0042e821c31e36d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefde83b30fd4dd99a0042e821c31e36d">&#9670;&nbsp;</a></span>write_model_at_bestfit() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::write_model_at_bestfit </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>xx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the model at xx with best-fit parameters obtained from posterior maximization </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output directory</td></tr>
    <tr><td class="paramname">output_file</td><td>the output file</td></tr>
    <tr><td class="paramname">xx</td><td>vector of points at which the model is computed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html#l00068">68</a> of file <a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html">Modelling1D.cpp</a>.</p>

</div>
</div>
<a id="aec0da5b6953bd3ef3039005b12027501"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec0da5b6953bd3ef3039005b12027501">&#9670;&nbsp;</a></span>write_model_at_bestfit() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::write_model_at_bestfit </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>yy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the model at xx, yy with best-fit parameters obtained from likelihood maximization </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output directory</td></tr>
    <tr><td class="paramname">output_file</td><td>the output file</td></tr>
    <tr><td class="paramname">xx</td><td>vector of points at which the model is computed, first axis</td></tr>
    <tr><td class="paramname">yy</td><td>vector of points at which the model is computed, second axis </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/db3/Modelling2D_8cpp_source.html#l00066">66</a> of file <a class="el" href="../../df/db3/Modelling2D_8cpp_source.html">Modelling2D.cpp</a>.</p>

</div>
</div>
<a id="a67ad5f68641af6da97e8c6702965698a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67ad5f68641af6da97e8c6702965698a">&#9670;&nbsp;</a></span>write_model_from_chains() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::write_model_from_chains </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>thin</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the model at xx computing 16th, 50th and 84th percentiles from the chains </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output directory</td></tr>
    <tr><td class="paramname">output_file</td><td>the output file</td></tr>
    <tr><td class="paramname">xx</td><td>vector of points at which the model is computed</td></tr>
    <tr><td class="paramname">start</td><td>the starting position for each chain</td></tr>
    <tr><td class="paramname">thin</td><td>the position step </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d7/d86/model_2pt_2D_8cpp-example.html#a25">model_2pt_2D.cpp</a>, and <a class="el" href="../../d4/db0/model_2pt_monopole_RSD_8cpp-example.html#a24">model_2pt_monopole_RSD.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html#l00080">80</a> of file <a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html">Modelling1D.cpp</a>.</p>

</div>
</div>
<a id="a77a3663b17bad9b29ba04641277c92b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a3663b17bad9b29ba04641277c92b2">&#9670;&nbsp;</a></span>write_model_from_chains() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::write_model_from_chains </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>yy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>thin</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the model at xx, yy computing 16th, 50th and 84th percentiles from the chains </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output directory</td></tr>
    <tr><td class="paramname">output_file</td><td>the output file</td></tr>
    <tr><td class="paramname">xx</td><td>vector of points at which the model is computed, first axis</td></tr>
    <tr><td class="paramname">yy</td><td>vector of points at which the model is computed, second axis</td></tr>
    <tr><td class="paramname">start</td><td>the starting position for each chain</td></tr>
    <tr><td class="paramname">thin</td><td>the position step </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/db3/Modelling2D_8cpp_source.html#l00078">78</a> of file <a class="el" href="../../df/db3/Modelling2D_8cpp_source.html">Modelling2D.cpp</a>.</p>

</div>
</div>
<a id="a0487a258098b3d434f9a77f8ad2a1971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0487a258098b3d434f9a77f8ad2a1971">&#9670;&nbsp;</a></span>write_results()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::Modelling::write_results </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>root_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>thin</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nbins</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>fits</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>compute_mode</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ns</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the results of the MCMC sampling to file </p>
<p>this function stores to file the posterior mean, the posterior standard deviation, the posterior median, 18th and 82th posterior percentiles, and, optionally, the posterior mode.</p>
<p>If the covariance matrix has been estimated from a set of mock catalogues, and the input parameters ns ( \(n_s\), the number of samples used to estimate the covariance matrix) is provided (&gt;0), then the parameter errors ( \(\sigma_p\)) will be corrected to take into account the uncertainities in the covariance estimate (Percival et al. 2014):</p>
<p class="formulaDsp">
\[ \sigma_p = \sqrt{\frac{1+B(n_b-n_p)}{1+A+B(n_p+1)}} \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ A = \frac{2}{(n_s-n_b-1)(n_s-n_b-4)} \,, \]
</p>
<p class="formulaDsp">
\[ B = \frac{(n_s-n_b-2)}{(n_s-n_b-1)(n_s-n_b-4)} \,, \]
</p>
<p>where \(n_b\) is number of data measurements (e.g. the bins of the dataset).</p>
<p>This correction can be applied only if the likelihood is Gaussian. Morever, the inverce covariance matrix estimator has to be corrected to take into account the inverse Wishart distribution (Hartlap, Simon and Schneider 2006).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output director</td></tr>
    <tr><td class="paramname">root_file</td><td>the root of the output files: - file_root_parameters.dat file containing the output of the MCMC sampling for each parameter - file_root_covariance.dat file containing the covariance of the parameters - file_root_chain file containing the chains: the extention can be .dat or .fits</td></tr>
    <tr><td class="paramname">start</td><td>the minimum chain position to be written</td></tr>
    <tr><td class="paramname">thin</td><td>the step used for dilution on screen</td></tr>
    <tr><td class="paramname">nbins</td><td>the number of bins</td></tr>
    <tr><td class="paramname">fits</td><td>false \(\rightarrow\) ascii file; true \(\rightarrow\) fits file</td></tr>
    <tr><td class="paramname">compute_mode</td><td>true \(\rightarrow\) compute the posterior mode; false \(\rightarrow\) do not compute the posterior mode</td></tr>
    <tr><td class="paramname">ns</td><td>number of samples used to estimate the covariance matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="../../d4/db0/model_2pt_monopole_RSD_8cpp-example.html#a23">model_2pt_monopole_RSD.cpp</a>, <a class="el" href="../../dd/d01/model_2pt_projected_8cpp-example.html#a21">model_2pt_projected.cpp</a>, and <a class="el" href="../../df/dbb/model_3pt_8cpp-example.html#a22">model_3pt.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d3d/Modelling_8cpp_source.html#l00257">257</a> of file <a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Headers/<a class="el" href="../../d5/d4c/Modelling_8h_source.html">Modelling.h</a></li>
<li>Modelling/Global/<a class="el" href="../../db/d3d/Modelling_8cpp_source.html">Modelling.cpp</a></li>
<li>Modelling/Global/<a class="el" href="../../d0/d17/Modelling1D_8cpp_source.html">Modelling1D.cpp</a></li>
<li>Modelling/Global/<a class="el" href="../../df/db3/Modelling2D_8cpp_source.html">Modelling2D.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d5/d33/namespacecbl.html">cbl</a></li><li class="navelem"><a class="el" href="../../d6/d92/namespacecbl_1_1modelling.html">modelling</a></li><li class="navelem"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html">Modelling</a></li>
    <li class="footer">Generated on Mon Nov 23 2020 18:32:32 for CosmoBolognaLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
