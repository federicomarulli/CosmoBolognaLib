<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CosmoBolognaLib: cbl::modelling::CombinedModelling Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CosmoBolognaLib
   </div>
   <div id="projectbrief">Free Software C++/Python libraries for cosmological calculations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../d2/d53/classcbl_1_1modelling_1_1CombinedModelling-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">cbl::modelling::CombinedModelling Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The class <a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html" title="The class CombinedModelling.">CombinedModelling</a>.  
 <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="../../db/d46/CombinedModelling_8h_source.html">Headers/CombinedModelling.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for cbl::modelling::CombinedModelling:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d15/classcbl_1_1modelling_1_1CombinedModelling__inherit__graph.png" border="0" usemap="#cbl_1_1modelling_1_1CombinedModelling_inherit__map" alt="Inheritance graph"/></div>
<map name="cbl_1_1modelling_1_1CombinedModelling_inherit__map" id="cbl_1_1modelling_1_1CombinedModelling_inherit__map">
<area shape="rect" title="The class CombinedModelling." alt="" coords="5,80,193,121"/>
<area shape="rect" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html" title="The class Modelling." alt="" coords="6,5,193,32"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for cbl::modelling::CombinedModelling:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/classcbl_1_1modelling_1_1CombinedModelling__coll__graph.png" border="0" usemap="#cbl_1_1modelling_1_1CombinedModelling_coll__map" alt="Collaboration graph"/></div>
<map name="cbl_1_1modelling_1_1CombinedModelling_coll__map" id="cbl_1_1modelling_1_1CombinedModelling_coll__map">
<area shape="rect" title="The class CombinedModelling." alt="" coords="5,80,193,121"/>
<area shape="rect" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html" title="The class Modelling." alt="" coords="6,5,193,32"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructors/destructors</div></td></tr>
<tr class="memitem:a736911c671539153cd2b6708810b5842"><td class="memItemLeft" align="right" valign="top"><a id="a736911c671539153cd2b6708810b5842"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a736911c671539153cd2b6708810b5842">CombinedModelling</a> ()=default</td></tr>
<tr class="memdesc:a736911c671539153cd2b6708810b5842"><td class="mdescLeft">&#160;</td><td class="mdescRight">default constuctor <br /></td></tr>
<tr class="separator:a736911c671539153cd2b6708810b5842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62798bb03ed39fd486d234f03562b8ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a62798bb03ed39fd486d234f03562b8ac">CombinedModelling</a> (std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html">modelling::Modelling</a> &gt;&gt; modelling, std::vector&lt; std::string &gt; repeated_par={}, const std::vector&lt; std::vector&lt; std::vector&lt; int &gt;&gt;&gt; common_repeated_par={})</td></tr>
<tr class="memdesc:a62798bb03ed39fd486d234f03562b8ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constuctor used to combine statistically independent probes.  <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a62798bb03ed39fd486d234f03562b8ac">More...</a><br /></td></tr>
<tr class="separator:a62798bb03ed39fd486d234f03562b8ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa034127a769da9a588f39a43e662b884"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#aa034127a769da9a588f39a43e662b884">CombinedModelling</a> (std::vector&lt; std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html">modelling::Modelling</a> &gt;&gt;&gt; modelling, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../dc/d32/classcbl_1_1data_1_1CovarianceMatrix.html">data::CovarianceMatrix</a> &gt;&gt; covariance, const std::vector&lt; <a class="el" href="../../de/d99/namespacecbl_1_1statistics.html#a38749ce915de37868b3dd080337fe609">cbl::statistics::LikelihoodType</a> &gt; likelihood_types, const std::vector&lt; std::string &gt; repeated_par={}, const std::vector&lt; std::vector&lt; std::vector&lt; int &gt;&gt;&gt; common_repeated_par={}, const std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../dd/dd8/classcbl_1_1cosmology_1_1SuperSampleCovariance.html">cosmology::SuperSampleCovariance</a> &gt;&gt; SSC={})</td></tr>
<tr class="memdesc:aa034127a769da9a588f39a43e662b884"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor used to set the modelling of statistically dependent probes. For each vector of <a class="el" href="../../d0/d0a/classcbl_1_1statistics_1_1Posterior.html" title="The class Posterior.">cbl::statistics::Posterior</a> objects in the <em>posteriors</em> argument, a <a class="el" href="../../dc/d32/classcbl_1_1data_1_1CovarianceMatrix.html" title="The class CovarianceMatrix.">cbl::data::CovarianceMatrix</a> object must be defined. The probes in each vector within <em>posteriors</em> are described by the same likelihood function. The final log-likelihood is given by the sum of the logarithms of each likelihood describing a set of dependent probes.  <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#aa034127a769da9a588f39a43e662b884">More...</a><br /></td></tr>
<tr class="separator:aa034127a769da9a588f39a43e662b884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30ff8e66c9a037fa743c3583ea870025"><td class="memItemLeft" align="right" valign="top"><a id="a30ff8e66c9a037fa743c3583ea870025"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a30ff8e66c9a037fa743c3583ea870025">~CombinedModelling</a> ()=default</td></tr>
<tr class="memdesc:a30ff8e66c9a037fa743c3583ea870025"><td class="mdescLeft">&#160;</td><td class="mdescRight">default destructor <br /></td></tr>
<tr class="separator:a30ff8e66c9a037fa743c3583ea870025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Member functions used to manage likelihood/posterior</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>distributions </p>
</div></td></tr>
<tr class="memitem:ae0afd78909626012955a376112cd806a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#ae0afd78909626012955a376112cd806a">maximize_combined_posterior</a> (const std::vector&lt; double &gt; start, const unsigned int max_iter=10000, const double tol=1.e-6, const double epsilon=1.e-3)</td></tr>
<tr class="memdesc:ae0afd78909626012955a376112cd806a"><td class="mdescLeft">&#160;</td><td class="mdescRight">function that maximizes the combined posterior, finds the best-fit parameters and stores them in the model  <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#ae0afd78909626012955a376112cd806a">More...</a><br /></td></tr>
<tr class="separator:ae0afd78909626012955a376112cd806a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52ee758f6dab965be776206e367bcba1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a52ee758f6dab965be776206e367bcba1">sample_combined_posterior</a> (const int chain_size, const int nwalkers, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a52ee758f6dab965be776206e367bcba1"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains by drawing from the prior distributions  <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a52ee758f6dab965be776206e367bcba1">More...</a><br /></td></tr>
<tr class="separator:a52ee758f6dab965be776206e367bcba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3965a47749d1a56909e83726f1f17976"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a3965a47749d1a56909e83726f1f17976">sample_combined_posterior</a> (const int chain_size, const int nwalkers, const double radius, const std::vector&lt; double &gt; start, const unsigned int max_iter=10000, const double tol=1.e-6, const double epsilon=1.e-3, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a3965a47749d1a56909e83726f1f17976"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains in a ball around the posterior best-fit parameters values  <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a3965a47749d1a56909e83726f1f17976">More...</a><br /></td></tr>
<tr class="separator:a3965a47749d1a56909e83726f1f17976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c32315984f467e5dadf253577c6d6fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a6c32315984f467e5dadf253577c6d6fd">sample_combined_posterior</a> (const int chain_size, const int nwalkers, const std::string input_dir, const std::string input_file, const int seed, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a6c32315984f467e5dadf253577c6d6fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains reading the input values from an input file  <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a6c32315984f467e5dadf253577c6d6fd">More...</a><br /></td></tr>
<tr class="separator:a6c32315984f467e5dadf253577c6d6fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Member functions used for Input/Output</div></td></tr>
<tr class="memitem:a7ec064a761e9029fb5e61ad7aa3478fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a7ec064a761e9029fb5e61ad7aa3478fc">write_combined_results</a> (const std::string output_dir, const std::string root_file, const int start=0, const int thin=1, const int nbins=50, const bool fits=false, const bool compute_mode=false, const int ns=-1)</td></tr>
<tr class="memdesc:a7ec064a761e9029fb5e61ad7aa3478fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the results of the MCMC sampling to file  <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a7ec064a761e9029fb5e61ad7aa3478fc">More...</a><br /></td></tr>
<tr class="separator:a7ec064a761e9029fb5e61ad7aa3478fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fe4bbae980f82fbb33c60b4092d08ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a6fe4bbae980f82fbb33c60b4092d08ac">write_model_from_combined_chain</a> (const std::string output_dir, const std::string output_file, const int start, const int thin)</td></tr>
<tr class="memdesc:a6fe4bbae980f82fbb33c60b4092d08ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model computing 16th, 50th and 84th percentiles from the MCMC  <a href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a6fe4bbae980f82fbb33c60b4092d08ac">More...</a><br /></td></tr>
<tr class="separator:a6fe4bbae980f82fbb33c60b4092d08ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classcbl_1_1modelling_1_1Modelling"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classcbl_1_1modelling_1_1Modelling')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html">cbl::modelling::Modelling</a></td></tr>
<tr class="memitem:a794eaee60fed0c6340b3c0a5ab0d9c87 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a794eaee60fed0c6340b3c0a5ab0d9c87">m_set_posterior</a> (const int seed)</td></tr>
<tr class="memdesc:a794eaee60fed0c6340b3c0a5ab0d9c87 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the interal variable m_posterior  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a794eaee60fed0c6340b3c0a5ab0d9c87">More...</a><br /></td></tr>
<tr class="separator:a794eaee60fed0c6340b3c0a5ab0d9c87 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86cda30c39275b78769dee5f87d5a3ae inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="a86cda30c39275b78769dee5f87d5a3ae"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a86cda30c39275b78769dee5f87d5a3ae">Modelling</a> ()=default</td></tr>
<tr class="memdesc:a86cda30c39275b78769dee5f87d5a3ae inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">default constuctor <br /></td></tr>
<tr class="separator:a86cda30c39275b78769dee5f87d5a3ae inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76e4598b3b1638680d0b0839938d99b4 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="a76e4598b3b1638680d0b0839938d99b4"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a76e4598b3b1638680d0b0839938d99b4">~Modelling</a> ()=default</td></tr>
<tr class="memdesc:a76e4598b3b1638680d0b0839938d99b4 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">default destructor <br /></td></tr>
<tr class="separator:a76e4598b3b1638680d0b0839938d99b4 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ee86f295c8046b3ff141fb8ce6effb inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a91ee86f295c8046b3ff141fb8ce6effb">data</a> ()</td></tr>
<tr class="memdesc:a91ee86f295c8046b3ff141fb8ce6effb inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the dataset  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a91ee86f295c8046b3ff141fb8ce6effb">More...</a><br /></td></tr>
<tr class="separator:a91ee86f295c8046b3ff141fb8ce6effb inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a330daeea0024b1404f4be9f5f54b6ea9 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a330daeea0024b1404f4be9f5f54b6ea9">data_fit</a> ()</td></tr>
<tr class="memdesc:a330daeea0024b1404f4be9f5f54b6ea9 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the dataset  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a330daeea0024b1404f4be9f5f54b6ea9">More...</a><br /></td></tr>
<tr class="separator:a330daeea0024b1404f4be9f5f54b6ea9 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada23253dbc0a2a128e6d82df60a88082 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d1/d68/classcbl_1_1statistics_1_1Likelihood.html">statistics::Likelihood</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ada23253dbc0a2a128e6d82df60a88082">likelihood</a> ()</td></tr>
<tr class="memdesc:ada23253dbc0a2a128e6d82df60a88082 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the likelihood parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ada23253dbc0a2a128e6d82df60a88082">More...</a><br /></td></tr>
<tr class="separator:ada23253dbc0a2a128e6d82df60a88082 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf69f3454bcbdb0c028d2c5da308ba69 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d0/d0a/classcbl_1_1statistics_1_1Posterior.html">statistics::Posterior</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aaf69f3454bcbdb0c028d2c5da308ba69">posterior</a> ()</td></tr>
<tr class="memdesc:aaf69f3454bcbdb0c028d2c5da308ba69 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the posterior parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aaf69f3454bcbdb0c028d2c5da308ba69">More...</a><br /></td></tr>
<tr class="separator:aaf69f3454bcbdb0c028d2c5da308ba69 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7fbfe639c97153b44ccf2c686c77ce inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d6/ddb/classcbl_1_1statistics_1_1ModelParameters.html">statistics::ModelParameters</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2a7fbfe639c97153b44ccf2c686c77ce">likelihood_parameters</a> ()</td></tr>
<tr class="memdesc:a2a7fbfe639c97153b44ccf2c686c77ce inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the likelihood parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2a7fbfe639c97153b44ccf2c686c77ce">More...</a><br /></td></tr>
<tr class="separator:a2a7fbfe639c97153b44ccf2c686c77ce inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ef1457bb68947fd5bfd6a6e39bcf69 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d6/ddb/classcbl_1_1statistics_1_1ModelParameters.html">statistics::ModelParameters</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#af9ef1457bb68947fd5bfd6a6e39bcf69">posterior_parameters</a> ()</td></tr>
<tr class="memdesc:af9ef1457bb68947fd5bfd6a6e39bcf69 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the posterior parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#af9ef1457bb68947fd5bfd6a6e39bcf69">More...</a><br /></td></tr>
<tr class="separator:af9ef1457bb68947fd5bfd6a6e39bcf69 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a548b6aab02fc41a02c759f7dd11c4e35 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a548b6aab02fc41a02c759f7dd11c4e35">set_parameter_from_string</a> (const std::string parameter, const double value)</td></tr>
<tr class="memdesc:a548b6aab02fc41a02c759f7dd11c4e35 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the value of a parameter providing its name string  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a548b6aab02fc41a02c759f7dd11c4e35">More...</a><br /></td></tr>
<tr class="separator:a548b6aab02fc41a02c759f7dd11c4e35 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a204182129ec99377f61a178b41f7070a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a204182129ec99377f61a178b41f7070a">get_parameter_from_string</a> (const std::string parameter) const</td></tr>
<tr class="memdesc:a204182129ec99377f61a178b41f7070a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the value of a parameter providing its name string  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a204182129ec99377f61a178b41f7070a">More...</a><br /></td></tr>
<tr class="separator:a204182129ec99377f61a178b41f7070a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cec2c9a631216ee223db41684464374 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d7/d79/classcbl_1_1statistics_1_1PriorDistribution.html">statistics::PriorDistribution</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a6cec2c9a631216ee223db41684464374">get_prior</a> (const int i)</td></tr>
<tr class="memdesc:a6cec2c9a631216ee223db41684464374 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the internal variable m_parameter_priors  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a6cec2c9a631216ee223db41684464374">More...</a><br /></td></tr>
<tr class="separator:a6cec2c9a631216ee223db41684464374 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e5278e638887760665d1e856fd6e71e inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d0/da1/classcbl_1_1statistics_1_1Model.html">statistics::Model</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a0e5278e638887760665d1e856fd6e71e">get_response_function</a> ()</td></tr>
<tr class="memdesc:a0e5278e638887760665d1e856fd6e71e inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the response function used to compute the super-sample covariance  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a0e5278e638887760665d1e856fd6e71e">More...</a><br /></td></tr>
<tr class="separator:a0e5278e638887760665d1e856fd6e71e inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be55435176151510d8466eba3ebe148 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2be55435176151510d8466eba3ebe148">reset_fit_range</a> ()</td></tr>
<tr class="memdesc:a2be55435176151510d8466eba3ebe148 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">reset the fit range  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2be55435176151510d8466eba3ebe148">More...</a><br /></td></tr>
<tr class="separator:a2be55435176151510d8466eba3ebe148 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5cbfd5aef8588edf6afd5c827da22d5 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ad5cbfd5aef8588edf6afd5c827da22d5">set_fit_range</a> (const double xmin, const double xmax)</td></tr>
<tr class="memdesc:ad5cbfd5aef8588edf6afd5c827da22d5 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the fit range  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ad5cbfd5aef8588edf6afd5c827da22d5">More...</a><br /></td></tr>
<tr class="separator:ad5cbfd5aef8588edf6afd5c827da22d5 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de1409cc2364923012ede688e191d62 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a8de1409cc2364923012ede688e191d62">set_fit_range</a> (const double xmin, const double xmax, const double ymin, const double ymax)</td></tr>
<tr class="memdesc:a8de1409cc2364923012ede688e191d62 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the fit range  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a8de1409cc2364923012ede688e191d62">More...</a><br /></td></tr>
<tr class="separator:a8de1409cc2364923012ede688e191d62 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8547d0cb8da2cbac56bc6cf19e7a49bb inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a8547d0cb8da2cbac56bc6cf19e7a49bb">set_data</a> (const std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt; dataset)</td></tr>
<tr class="memdesc:a8547d0cb8da2cbac56bc6cf19e7a49bb inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the dataset  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a8547d0cb8da2cbac56bc6cf19e7a49bb">More...</a><br /></td></tr>
<tr class="separator:a8547d0cb8da2cbac56bc6cf19e7a49bb inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91c33ea880d3d54a4e38b2d686082a81 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a91c33ea880d3d54a4e38b2d686082a81">set_likelihood</a> (const <a class="el" href="../../de/d99/namespacecbl_1_1statistics.html#a38749ce915de37868b3dd080337fe609">statistics::LikelihoodType</a> likelihood_type, const std::vector&lt; size_t &gt; x_index={0, 2}, const int w_index=-1, const double prec=1.e-10, const int Nres=-1)</td></tr>
<tr class="memdesc:a91c33ea880d3d54a4e38b2d686082a81 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the likelihood function  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a91c33ea880d3d54a4e38b2d686082a81">More...</a><br /></td></tr>
<tr class="separator:a91c33ea880d3d54a4e38b2d686082a81 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d908393ab854aedcb14c3c5f27fc77f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a9d908393ab854aedcb14c3c5f27fc77f">set_likelihood</a> (const <a class="el" href="../../de/d99/namespacecbl_1_1statistics.html#acf72f4e71049b46a5891a70d55a04795">cbl::statistics::Likelihood_function</a> log_likelihood_function)</td></tr>
<tr class="memdesc:a9d908393ab854aedcb14c3c5f27fc77f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the likelihood function, given a user-defined log-likelihood function  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a9d908393ab854aedcb14c3c5f27fc77f">More...</a><br /></td></tr>
<tr class="separator:a9d908393ab854aedcb14c3c5f27fc77f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bfa4a1a26f75c6133013f83a1d6bd0a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a3bfa4a1a26f75c6133013f83a1d6bd0a">maximize_likelihood</a> (const std::vector&lt; double &gt; start, const std::vector&lt; std::vector&lt; double &gt;&gt; parameter_limits, const unsigned int max_iter=10000, const double tol=1.e-6, const double epsilon=1.e-3)</td></tr>
<tr class="memdesc:a3bfa4a1a26f75c6133013f83a1d6bd0a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">function that maximizes the posterior, finds the best-fit parameters and stores them in the model  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a3bfa4a1a26f75c6133013f83a1d6bd0a">More...</a><br /></td></tr>
<tr class="separator:a3bfa4a1a26f75c6133013f83a1d6bd0a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcd5acc340f0a633f9f68be84614f518 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#afcd5acc340f0a633f9f68be84614f518">maximize_posterior</a> (const std::vector&lt; double &gt; start, const unsigned int max_iter=10000, const double tol=1.e-6, const double epsilon=1.e-3, const int seed=666)</td></tr>
<tr class="memdesc:afcd5acc340f0a633f9f68be84614f518 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">function that maximizes the posterior, finds the best-fit parameters and stores them in the model  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#afcd5acc340f0a633f9f68be84614f518">More...</a><br /></td></tr>
<tr class="separator:afcd5acc340f0a633f9f68be84614f518 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab445d85cdc90a0d985f1a929b74caeea inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ab445d85cdc90a0d985f1a929b74caeea">sample_posterior</a> (const int chain_size, const int nwalkers, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:ab445d85cdc90a0d985f1a929b74caeea inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains by drawing from the prior distributions  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ab445d85cdc90a0d985f1a929b74caeea">More...</a><br /></td></tr>
<tr class="separator:ab445d85cdc90a0d985f1a929b74caeea inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae70e752db358077ed1e5a91668ab719f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ae70e752db358077ed1e5a91668ab719f">sample_posterior</a> (const int chain_size, const int nwalkers, const double radius, const std::vector&lt; double &gt; start, const unsigned int max_iter=10000, const double tol=1.e-6, const double epsilon=1.e-3, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:ae70e752db358077ed1e5a91668ab719f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains in a ball around the posterior best-fit parameters values  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ae70e752db358077ed1e5a91668ab719f">More...</a><br /></td></tr>
<tr class="separator:ae70e752db358077ed1e5a91668ab719f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d4f131007a7f5b2b6055f50f72747a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a16d4f131007a7f5b2b6055f50f72747a">sample_posterior</a> (const int chain_size, const int nwalkers, std::vector&lt; double &gt; &amp;value, const double radius, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a16d4f131007a7f5b2b6055f50f72747a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains by drawing from the prior distributions  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a16d4f131007a7f5b2b6055f50f72747a">More...</a><br /></td></tr>
<tr class="separator:a16d4f131007a7f5b2b6055f50f72747a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a235f03023183ac37ebb201be362abe63 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a235f03023183ac37ebb201be362abe63">sample_posterior</a> (const int chain_size, const std::vector&lt; std::vector&lt; double &gt;&gt; chain_value, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a235f03023183ac37ebb201be362abe63 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains with input values  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a235f03023183ac37ebb201be362abe63">More...</a><br /></td></tr>
<tr class="separator:a235f03023183ac37ebb201be362abe63 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c661eca5cd2909dd1f303fa20dafd8f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4c661eca5cd2909dd1f303fa20dafd8f">sample_posterior</a> (const int chain_size, const int nwalkers, const std::string input_dir, const std::string input_file, const int seed=666, const double aa=2, const bool parallel=true)</td></tr>
<tr class="memdesc:a4c661eca5cd2909dd1f303fa20dafd8f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample the posterior, initializing the chains reading the input values from an input file  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4c661eca5cd2909dd1f303fa20dafd8f">More...</a><br /></td></tr>
<tr class="separator:a4c661eca5cd2909dd1f303fa20dafd8f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a268d877709d3bce4f4477d054bfc1ec6 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a268d877709d3bce4f4477d054bfc1ec6">importance_sampling</a> (const std::string input_dir, const std::string input_file, const int seed=666, const std::vector&lt; size_t &gt; column={}, const int header_lines_to_skip=1, const bool is_FITS_format=false, const bool apply_to_likelihood=false)</td></tr>
<tr class="memdesc:a268d877709d3bce4f4477d054bfc1ec6 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform importance sampling  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a268d877709d3bce4f4477d054bfc1ec6">More...</a><br /></td></tr>
<tr class="separator:a268d877709d3bce4f4477d054bfc1ec6 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45480d79ce4c73c99690029c47bc36aa inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a45480d79ce4c73c99690029c47bc36aa">write_chain</a> (const std::string output_dir, const std::string output_file, const int start=0, const int thin=1, const bool is_FITS_format=false, const int prec=5, const int ww=14)</td></tr>
<tr class="memdesc:a45480d79ce4c73c99690029c47bc36aa inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the chains obtained after the MCMC sampling  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a45480d79ce4c73c99690029c47bc36aa">More...</a><br /></td></tr>
<tr class="separator:a45480d79ce4c73c99690029c47bc36aa inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673765574ab67435911ea251ad0ab954 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a673765574ab67435911ea251ad0ab954">read_chain</a> (const std::string input_dir, const std::string input_file, const int nwalkers, const std::vector&lt; size_t &gt; columns={}, const int skip_header=1, const bool fits=false)</td></tr>
<tr class="memdesc:a673765574ab67435911ea251ad0ab954 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">read the chains  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a673765574ab67435911ea251ad0ab954">More...</a><br /></td></tr>
<tr class="separator:a673765574ab67435911ea251ad0ab954 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e99a06a0ec551ff4f4c77d3ff03366 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a58e99a06a0ec551ff4f4c77d3ff03366">show_results</a> (const int start=0, const int thin=1, const int nbins=50, const bool show_mode=false, const int ns=-1)</td></tr>
<tr class="memdesc:a58e99a06a0ec551ff4f4c77d3ff03366 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">show the results of the MCMC sampling on screen  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a58e99a06a0ec551ff4f4c77d3ff03366">More...</a><br /></td></tr>
<tr class="separator:a58e99a06a0ec551ff4f4c77d3ff03366 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0487a258098b3d434f9a77f8ad2a1971 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a0487a258098b3d434f9a77f8ad2a1971">write_results</a> (const std::string output_dir, const std::string root_file, const int start=0, const int thin=1, const int nbins=50, const bool fits=false, const bool compute_mode=false, const int ns=-1)</td></tr>
<tr class="memdesc:a0487a258098b3d434f9a77f8ad2a1971 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the results of the MCMC sampling to file  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a0487a258098b3d434f9a77f8ad2a1971">More...</a><br /></td></tr>
<tr class="separator:a0487a258098b3d434f9a77f8ad2a1971 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7775893be4bd28e20cf75c85d5da009f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a7775893be4bd28e20cf75c85d5da009f">write_model</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const std::vector&lt; double &gt; parameters)</td></tr>
<tr class="memdesc:a7775893be4bd28e20cf75c85d5da009f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx for given parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a7775893be4bd28e20cf75c85d5da009f">More...</a><br /></td></tr>
<tr class="separator:a7775893be4bd28e20cf75c85d5da009f inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4858755764d9acc999c61272eff73916 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4858755764d9acc999c61272eff73916">write_model</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const std::vector&lt; double &gt; yy, const std::vector&lt; double &gt; parameters)</td></tr>
<tr class="memdesc:a4858755764d9acc999c61272eff73916 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx, yy for given parameters  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4858755764d9acc999c61272eff73916">More...</a><br /></td></tr>
<tr class="separator:a4858755764d9acc999c61272eff73916 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefde83b30fd4dd99a0042e821c31e36d inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aefde83b30fd4dd99a0042e821c31e36d">write_model_at_bestfit</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx)</td></tr>
<tr class="memdesc:aefde83b30fd4dd99a0042e821c31e36d inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx with best-fit parameters obtained from posterior maximization  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aefde83b30fd4dd99a0042e821c31e36d">More...</a><br /></td></tr>
<tr class="separator:aefde83b30fd4dd99a0042e821c31e36d inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0da5b6953bd3ef3039005b12027501 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aec0da5b6953bd3ef3039005b12027501">write_model_at_bestfit</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const std::vector&lt; double &gt; yy)</td></tr>
<tr class="memdesc:aec0da5b6953bd3ef3039005b12027501 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx, yy with best-fit parameters obtained from likelihood maximization  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#aec0da5b6953bd3ef3039005b12027501">More...</a><br /></td></tr>
<tr class="separator:aec0da5b6953bd3ef3039005b12027501 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ad5f68641af6da97e8c6702965698a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a67ad5f68641af6da97e8c6702965698a">write_model_from_chains</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const int start=0, const int thin=1)</td></tr>
<tr class="memdesc:a67ad5f68641af6da97e8c6702965698a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx computing 16th, 50th and 84th percentiles from the chains  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a67ad5f68641af6da97e8c6702965698a">More...</a><br /></td></tr>
<tr class="separator:a67ad5f68641af6da97e8c6702965698a inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a3663b17bad9b29ba04641277c92b2 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a77a3663b17bad9b29ba04641277c92b2">write_model_from_chains</a> (const std::string output_dir, const std::string output_file, const std::vector&lt; double &gt; xx, const std::vector&lt; double &gt; yy, const int start=0, const int thin=1)</td></tr>
<tr class="memdesc:a77a3663b17bad9b29ba04641277c92b2 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">write the model at xx, yy computing 16th, 50th and 84th percentiles from the chains  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a77a3663b17bad9b29ba04641277c92b2">More...</a><br /></td></tr>
<tr class="separator:a77a3663b17bad9b29ba04641277c92b2 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a58723e3ca16506358cdbb26471c21 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a20a58723e3ca16506358cdbb26471c21">reduced_chi2</a> (const std::vector&lt; double &gt; parameter={})</td></tr>
<tr class="memdesc:a20a58723e3ca16506358cdbb26471c21 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">the reduced \(\chi^2\)  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a20a58723e3ca16506358cdbb26471c21">More...</a><br /></td></tr>
<tr class="separator:a20a58723e3ca16506358cdbb26471c21 inherit pub_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a69d1e80f332a89b0a0eece1d633eb209"><td class="memItemLeft" align="right" valign="top"><a id="a69d1e80f332a89b0a0eece1d633eb209"></a>
std::shared_ptr&lt; <a class="el" href="../../d3/dae/classcbl_1_1statistics_1_1CombinedPosterior.html">statistics::CombinedPosterior</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html#a69d1e80f332a89b0a0eece1d633eb209">m_combined_posterior</a></td></tr>
<tr class="memdesc:a69d1e80f332a89b0a0eece1d633eb209"><td class="mdescLeft">&#160;</td><td class="mdescRight">combined posterior <br /></td></tr>
<tr class="separator:a69d1e80f332a89b0a0eece1d633eb209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classcbl_1_1modelling_1_1Modelling"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classcbl_1_1modelling_1_1Modelling')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html">cbl::modelling::Modelling</a></td></tr>
<tr class="memitem:a2f188e53e2cff3cf3cee94a0c7b0c0b0 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="a2f188e53e2cff3cf3cee94a0c7b0c0b0"></a>
std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a2f188e53e2cff3cf3cee94a0c7b0c0b0">m_data</a> = NULL</td></tr>
<tr class="memdesc:a2f188e53e2cff3cf3cee94a0c7b0c0b0 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">input data to be modelled <br /></td></tr>
<tr class="separator:a2f188e53e2cff3cf3cee94a0c7b0c0b0 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a125242587d7dd812e3c80b7a03234055 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="a125242587d7dd812e3c80b7a03234055"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a125242587d7dd812e3c80b7a03234055">m_fit_range</a> = false</td></tr>
<tr class="memdesc:a125242587d7dd812e3c80b7a03234055 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if fit range has been set <br /></td></tr>
<tr class="separator:a125242587d7dd812e3c80b7a03234055 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae184e3332f742c7dc18ea4112fe0ef5d inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="ae184e3332f742c7dc18ea4112fe0ef5d"></a>
std::shared_ptr&lt; <a class="el" href="../../d4/df1/classcbl_1_1data_1_1Data.html">data::Data</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ae184e3332f742c7dc18ea4112fe0ef5d">m_data_fit</a></td></tr>
<tr class="memdesc:ae184e3332f742c7dc18ea4112fe0ef5d inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">input data restricted to the range used for the fit <br /></td></tr>
<tr class="separator:ae184e3332f742c7dc18ea4112fe0ef5d inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae945eb8214037f249dee1a4283173821 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="ae945eb8214037f249dee1a4283173821"></a>
std::shared_ptr&lt; <a class="el" href="../../d0/da1/classcbl_1_1statistics_1_1Model.html">statistics::Model</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ae945eb8214037f249dee1a4283173821">m_model</a> = NULL</td></tr>
<tr class="memdesc:ae945eb8214037f249dee1a4283173821 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">input model <br /></td></tr>
<tr class="separator:ae945eb8214037f249dee1a4283173821 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0014aac365ec720e46a96dd909c00162 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="a0014aac365ec720e46a96dd909c00162"></a>
std::shared_ptr&lt; <a class="el" href="../../d0/da1/classcbl_1_1statistics_1_1Model.html">statistics::Model</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a0014aac365ec720e46a96dd909c00162">m_response_func</a> = NULL</td></tr>
<tr class="memdesc:a0014aac365ec720e46a96dd909c00162 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">response function for the computation of the super-sample covariance <br /></td></tr>
<tr class="separator:a0014aac365ec720e46a96dd909c00162 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b9f7d0422248cb12bc77329d0e57ec4 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="a5b9f7d0422248cb12bc77329d0e57ec4"></a>
std::shared_ptr&lt; <a class="el" href="../../d1/d68/classcbl_1_1statistics_1_1Likelihood.html">statistics::Likelihood</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a5b9f7d0422248cb12bc77329d0e57ec4">m_likelihood</a> = NULL</td></tr>
<tr class="memdesc:a5b9f7d0422248cb12bc77329d0e57ec4 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">likelihood <br /></td></tr>
<tr class="separator:a5b9f7d0422248cb12bc77329d0e57ec4 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4938c3d2de13efabf2709d6ff8de9412 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="a4938c3d2de13efabf2709d6ff8de9412"></a>
std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../d7/d79/classcbl_1_1statistics_1_1PriorDistribution.html">statistics::PriorDistribution</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a4938c3d2de13efabf2709d6ff8de9412">m_parameter_priors</a></td></tr>
<tr class="memdesc:a4938c3d2de13efabf2709d6ff8de9412 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">prior <br /></td></tr>
<tr class="separator:a4938c3d2de13efabf2709d6ff8de9412 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a08e71b68b4c0e56f15328415887f24 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="a5a08e71b68b4c0e56f15328415887f24"></a>
std::shared_ptr&lt; <a class="el" href="../../d0/d0a/classcbl_1_1statistics_1_1Posterior.html">statistics::Posterior</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a5a08e71b68b4c0e56f15328415887f24">m_posterior</a> = NULL</td></tr>
<tr class="memdesc:a5a08e71b68b4c0e56f15328415887f24 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">posterior <br /></td></tr>
<tr class="separator:a5a08e71b68b4c0e56f15328415887f24 inherit pro_attribs_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classcbl_1_1modelling_1_1Modelling"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classcbl_1_1modelling_1_1Modelling')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html">cbl::modelling::Modelling</a></td></tr>
<tr class="memitem:a478a15996b663ed9714d966ed325917f inherit pro_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a478a15996b663ed9714d966ed325917f">m_set_prior</a> (std::vector&lt; <a class="el" href="../../d7/d79/classcbl_1_1statistics_1_1PriorDistribution.html">statistics::PriorDistribution</a> &gt; prior_distribution)</td></tr>
<tr class="memdesc:a478a15996b663ed9714d966ed325917f inherit pro_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the internal variable m_parameter_priors  <a href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#a478a15996b663ed9714d966ed325917f">More...</a><br /></td></tr>
<tr class="separator:a478a15996b663ed9714d966ed325917f inherit pro_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71e45fd15203e808e83894a34bdbb76 inherit pro_methods_classcbl_1_1modelling_1_1Modelling"><td class="memItemLeft" align="right" valign="top"><a id="ac71e45fd15203e808e83894a34bdbb76"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html#ac71e45fd15203e808e83894a34bdbb76">m_isSet_response</a> ()</td></tr>
<tr class="memdesc:ac71e45fd15203e808e83894a34bdbb76 inherit pro_methods_classcbl_1_1modelling_1_1Modelling"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if the response function used to compute the super-sample covariance is set <br /></td></tr>
<tr class="separator:ac71e45fd15203e808e83894a34bdbb76 inherit pro_methods_classcbl_1_1modelling_1_1Modelling"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The class <a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html" title="The class CombinedModelling.">CombinedModelling</a>. </p>
<p>This file defines the interface of the base class <a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html" title="The class CombinedModelling.">CombinedModelling</a>, used for combining any kind of modelling </p>

<p class="definition">Definition at line <a class="el" href="../../db/d46/CombinedModelling_8h_source.html#l00065">65</a> of file <a class="el" href="../../db/d46/CombinedModelling_8h_source.html">CombinedModelling.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a62798bb03ed39fd486d234f03562b8ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62798bb03ed39fd486d234f03562b8ac">&#9670;&nbsp;</a></span>CombinedModelling() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cbl::modelling::CombinedModelling::CombinedModelling </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html">modelling::Modelling</a> &gt;&gt;&#160;</td>
          <td class="paramname"><em>modelling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>repeated_par</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::vector&lt; int &gt;&gt;&gt;&#160;</td>
          <td class="paramname"><em>common_repeated_par</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constuctor used to combine statistically independent probes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">modelling</td><td>vector of pointers to the single <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html" title="The class Modelling.">Modelling</a> objects</td></tr>
    <tr><td class="paramname">repeated_par</td><td>parameters shared by different probes, for which the user wants different posteriors for each probe. For example, if the probes A and B depend on the same parameter \(p\), whose identification string is "par", then "par" must be given in input if the user desires to have different posteriors of \(p\) for the two probes A and B. Every probe depending on \(p\) will provide a different posterior on \(p\). This is useful in the case of astrophysical parameters, e.g. the parameters describing galaxy cluster profiles.</td></tr>
    <tr><td class="paramname">common_repeated_par</td><td>for each argument in repeated_par, a vector of vectors of integers can be defined here. Such vectors define the sets of probes for which the same priors and posteriors are provided for the same parameters. For example, let us consider the probes {A1, A2, A3, A4}, provided in the modelling parameter. All the probes (A1, A2, A3, A4) depend on the parameter \(p\), whose identification string is "par", and we set repeated_par = {"par"}. If we want the pair of probes {A1, A2}, {A3, A4}, to provide a different posterior on \(p\), we must set common_repeated_par = { { {0,1}, {2,3} } }. This is useful when different probes in the same bin provide constraints on the same parameters. If common_repeated_par is not provided, every probe depending on \(p\) will provide a different posterior on \(p\). If two parameters are provided in repeated_par, e.g. repeated_par = {"par1", "par2"}, and only "par2" must be shared by more than one probe, then leave blank the vector of vectors corresponding to "par1" in common_repeated_par. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html#l00046">46</a> of file <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a>.</p>

</div>
</div>
<a id="aa034127a769da9a588f39a43e662b884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa034127a769da9a588f39a43e662b884">&#9670;&nbsp;</a></span>CombinedModelling() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cbl::modelling::CombinedModelling::CombinedModelling </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html">modelling::Modelling</a> &gt;&gt;&gt;&#160;</td>
          <td class="paramname"><em>modelling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../dc/d32/classcbl_1_1data_1_1CovarianceMatrix.html">data::CovarianceMatrix</a> &gt;&gt;&#160;</td>
          <td class="paramname"><em>covariance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../de/d99/namespacecbl_1_1statistics.html#a38749ce915de37868b3dd080337fe609">cbl::statistics::LikelihoodType</a> &gt;&#160;</td>
          <td class="paramname"><em>likelihood_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>repeated_par</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::vector&lt; int &gt;&gt;&gt;&#160;</td>
          <td class="paramname"><em>common_repeated_par</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="../../dd/dd8/classcbl_1_1cosmology_1_1SuperSampleCovariance.html">cosmology::SuperSampleCovariance</a> &gt;&gt;&#160;</td>
          <td class="paramname"><em>SSC</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor used to set the modelling of statistically dependent probes. For each vector of <a class="el" href="../../d0/d0a/classcbl_1_1statistics_1_1Posterior.html" title="The class Posterior.">cbl::statistics::Posterior</a> objects in the <em>posteriors</em> argument, a <a class="el" href="../../dc/d32/classcbl_1_1data_1_1CovarianceMatrix.html" title="The class CovarianceMatrix.">cbl::data::CovarianceMatrix</a> object must be defined. The probes in each vector within <em>posteriors</em> are described by the same likelihood function. The final log-likelihood is given by the sum of the logarithms of each likelihood describing a set of dependent probes. </p>
<p>If sets of probes are described by user-defined likelihoods, then the <a class="el" href="../../dc/d32/classcbl_1_1data_1_1CovarianceMatrix.html" title="The class CovarianceMatrix.">cbl::data::CovarianceMatrix</a> objects must not be provided for such sets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">modelling</td><td>vector of vectors of pointers to <a class="el" href="../../de/ddc/classcbl_1_1modelling_1_1Modelling.html" title="The class Modelling.">Modelling</a> objects. In each vector, a set of probes is contained, with a covariance matrix defined by the corresponding <a class="el" href="../../dc/d32/classcbl_1_1data_1_1CovarianceMatrix.html" title="The class CovarianceMatrix.">cbl::data::CovarianceMatrix</a> object given as input in the second argument of this constructor</td></tr>
    <tr><td class="paramname">covariance</td><td>objects defining the covariance matrices for the Posterior objects</td></tr>
    <tr><td class="paramname">likelihood_types</td><td>likelihood types for each set of probes</td></tr>
    <tr><td class="paramname">repeated_par</td><td>parameters shared by different probes, for which the user wants different posteriors for each probe. For example, if the probes A and B depend on the same parameter \(p\), whose identification string is "par", then "par" must be given in input if the user desires to have different posteriors of \(p\) for the two probes A and B. This is useful in the case of astrophysical parameters, e.g. the parameters describing galaxy cluster profiles.</td></tr>
    <tr><td class="paramname">common_repeated_par</td><td>for each argument in repeated_par, a vector of vectors of integers can be defined here. Such vectors define the sets of probes for which the same priors and posteriors are provided for the same parameters. For example, let us consider the two sets of probes {A1, A2, A3} and {B1, B2, B3}, provided in the modelling parameter. All the probes (A1, A2, A3, B1, B2, B3) depend on the parameter \(p\), whose identification string is "par", and we set repeated_par = {"par"}. If we want each pair of probes {A1, B1}, {A2, B2}, {A3, B3}, to provide a different posterior on \(p\), we must set common_repeated_par = { { {0,3}, {1,4}, {2,5} } }. This is useful when different probes in the same bin provide constraints on the same parameters. If common_repeated_par is not provided, every probe depending on \(p\) will provide a different posterior on \(p\). If two parameters are provided in repeated_par, e.g. repeated_par = {"par1", "par2"}, and only "par2" must be shared by more than one probe, then leave blank the vector of vectors corresponding to "par1" in common_repeated_par.</td></tr>
    <tr><td class="paramname">SSC</td><td>vector of pointers to <a class="el" href="../../dd/dd8/classcbl_1_1cosmology_1_1SuperSampleCovariance.html" title="The class SuperSampleCovariance.">cbl::cosmology::SuperSampleCovariance</a> objects, for the computation of the \(S_{ij}\) matrices. If, for example, the sets of probes A, B, C, are considered, and only for A and C the super-sample covariance must be computed, then set the second element of <em>SSC</em> equal to <em>NULL</em>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html#l00061">61</a> of file <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae0afd78909626012955a376112cd806a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0afd78909626012955a376112cd806a">&#9670;&nbsp;</a></span>maximize_combined_posterior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::CombinedModelling::maximize_combined_posterior </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>10000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1.e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1.e-3</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>function that maximizes the combined posterior, finds the best-fit parameters and stores them in the model </p>
<p>this function exploits the Nelder-Mead method <a href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method</a></p>
<p>the algorithm defines a simplex (i.e a k-dimensional polytope which is the convex hull of its k+1 vertices) in the parameter space. At each step, it identifies the simplex vertex at which the function to be minimised (i.e. the negative posterior in this case) has the greatest value, and moves it, via reflections and scaling, to a new position in which the function has a lower value. This iteration stops when the simplex area becomes lower than the tolerance. For instance, in 2D, the starting vertices of the simplex (a triangle in 2D) are the following: (start[0], start[1]) ; (start[0]+epsilon, start[1]) ; (start[0], start[1]+epsilon)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start</td><td>vector containing initial values for the posterior maximization</td></tr>
    <tr><td class="paramname">max_iter</td><td>the maximum number of iterations</td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance to find convergence</td></tr>
    <tr><td class="paramname">epsilon</td><td>the relative fraction of the initial simplex size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html#l00079">79</a> of file <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a>.</p>

</div>
</div>
<a id="a52ee758f6dab965be776206e367bcba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52ee758f6dab965be776206e367bcba1">&#9670;&nbsp;</a></span>sample_combined_posterior() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::CombinedModelling::sample_combined_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>chain_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>aa</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sample the posterior, initializing the chains by drawing from the prior distributions </p>
<p>the starting values of the chain are extracted from the (possibly different) distributions of the priors</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_size</td><td>the chain lenght</td></tr>
    <tr><td class="paramname">nwalkers</td><td>the number of parallel chains</td></tr>
    <tr><td class="paramname">aa</td><td>the parameter of the \(g(z)\) distribution</td></tr>
    <tr><td class="paramname">parallel</td><td>false \(\rightarrow\) non-parallel sampler; true \(\rightarrow\) parallel sampler </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html#l00088">88</a> of file <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a>.</p>

</div>
</div>
<a id="a3965a47749d1a56909e83726f1f17976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3965a47749d1a56909e83726f1f17976">&#9670;&nbsp;</a></span>sample_combined_posterior() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::CombinedModelling::sample_combined_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>chain_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>10000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1.e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1.e-3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>aa</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sample the posterior, initializing the chains in a ball around the posterior best-fit parameters values </p>
<p>the starting values of the chain are extracted from uniform distributions in the range [parameter-radius, parameter+radius] (for each likelihood parameter)</p>
<p>this function first maximizes the posterior, starting the computation at the values of the input vector 'start', then it inizializes the chain</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_size</td><td>the chain lenght</td></tr>
    <tr><td class="paramname">nwalkers</td><td>the number of parallel chains</td></tr>
    <tr><td class="paramname">radius</td><td>radius of the ball in parameter space</td></tr>
    <tr><td class="paramname">start</td><td>std::vector containing initial values for the posterior maximization</td></tr>
    <tr><td class="paramname">max_iter</td><td>the maximum number of iterations</td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance in finding convergence</td></tr>
    <tr><td class="paramname">epsilon</td><td>the simplex side</td></tr>
    <tr><td class="paramname">aa</td><td>the parameter of the \(g(z)\) distribution</td></tr>
    <tr><td class="paramname">parallel</td><td>false \(\rightarrow\) non-parallel sampler; true \(\rightarrow\) parallel sampler </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html#l00098">98</a> of file <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a>.</p>

</div>
</div>
<a id="a6c32315984f467e5dadf253577c6d6fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c32315984f467e5dadf253577c6d6fd">&#9670;&nbsp;</a></span>sample_combined_posterior() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::CombinedModelling::sample_combined_posterior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>chain_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nwalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>input_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>aa</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sample the posterior, initializing the chains reading the input values from an input file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_size</td><td>the chain lenght</td></tr>
    <tr><td class="paramname">nwalkers</td><td>the number of parallel chains</td></tr>
    <tr><td class="paramname">input_dir</td><td>input directory</td></tr>
    <tr><td class="paramname">input_file</td><td>input file</td></tr>
    <tr><td class="paramname">seed</td><td>the seed</td></tr>
    <tr><td class="paramname">aa</td><td>the parameter of the \(g(z)\) distribution</td></tr>
    <tr><td class="paramname">parallel</td><td>false \(\rightarrow\) non-parallel sampler; true \(\rightarrow\) parallel sampler </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html#l00108">108</a> of file <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a>.</p>

</div>
</div>
<a id="a7ec064a761e9029fb5e61ad7aa3478fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ec064a761e9029fb5e61ad7aa3478fc">&#9670;&nbsp;</a></span>write_combined_results()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::CombinedModelling::write_combined_results </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>root_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>thin</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nbins</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>fits</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>compute_mode</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ns</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the results of the MCMC sampling to file </p>
<p>this function stores to file the posterior mean, the posterior standard deviation, the posterior median, 18th and 82th posterior percentiles, and, optionally, the posterior mode.</p>
<p>If the covariance matrix has been estimated from a set of mock catalogues, and the input parameters ns ( \(n_s\), the number of samples used to estimate the covariance matrix) is provided (&gt;0), then the parameter errors ( \(\sigma_p\)) will be corrected to take into account the uncertainities in the covariance estimate (Percival et al. 2014):</p>
<p class="formulaDsp">
\[ \sigma_p = \sqrt{\frac{1+B(n_b-n_p)}{1+A+B(n_p+1)}} \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ A = \frac{2}{(n_s-n_b-1)(n_s-n_b-4)} \,, \]
</p>
<p class="formulaDsp">
\[ B = \frac{(n_s-n_b-2)}{(n_s-n_b-1)(n_s-n_b-4)} \,, \]
</p>
<p>where \(n_b\) is number of data measurements (e.g. the bins of the dataset).</p>
<p>This correction can be applied only if the likelihood is Gaussian. Morever, the inverce covariance matrix estimator has to be corrected to take into account the inverse Wishart distribution (Hartlap, Simon and Schneider 2006).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output director</td></tr>
    <tr><td class="paramname">root_file</td><td>the root of the output files: - file_root_parameters.dat file containing the output of the MCMC sampling for each parameter - file_root_covariance.dat file containing the covariance of the parameters - file_root_chain file containing the chains: the extention can be .dat or .fits</td></tr>
    <tr><td class="paramname">start</td><td>the minimum chain position to be written</td></tr>
    <tr><td class="paramname">thin</td><td>the step used for dilution on screen</td></tr>
    <tr><td class="paramname">nbins</td><td>the number of bins</td></tr>
    <tr><td class="paramname">fits</td><td>false \(\rightarrow\) ascii file; true \(\rightarrow\) fits file</td></tr>
    <tr><td class="paramname">compute_mode</td><td>true \(\rightarrow\) compute the posterior mode; false \(\rightarrow\) do not compute the posterior mode</td></tr>
    <tr><td class="paramname">ns</td><td>number of samples used to estimate the covariance matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html#l00118">118</a> of file <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a>.</p>

</div>
</div>
<a id="a6fe4bbae980f82fbb33c60b4092d08ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fe4bbae980f82fbb33c60b4092d08ac">&#9670;&nbsp;</a></span>write_model_from_combined_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbl::modelling::CombinedModelling::write_model_from_combined_chain </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>thin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write the model computing 16th, 50th and 84th percentiles from the MCMC </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_dir</td><td>the output directory</td></tr>
    <tr><td class="paramname">output_file</td><td>the output file</td></tr>
    <tr><td class="paramname">start</td><td>the minimum chain position to be written</td></tr>
    <tr><td class="paramname">thin</td><td>the step used for dilution on screen </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html#l00127">127</a> of file <a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Headers/<a class="el" href="../../db/d46/CombinedModelling_8h_source.html">CombinedModelling.h</a></li>
<li>Modelling/Global/<a class="el" href="../../d3/d2a/CombinedModelling_8cpp_source.html">CombinedModelling.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d5/d33/namespacecbl.html">cbl</a></li><li class="navelem"><a class="el" href="../../d6/d92/namespacecbl_1_1modelling.html">modelling</a></li><li class="navelem"><a class="el" href="../../dc/db8/classcbl_1_1modelling_1_1CombinedModelling.html">CombinedModelling</a></li>
    <li class="footer">Generated on Sat Jul 30 2022 16:09:14 for CosmoBolognaLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
